<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>Arcade Studio</title>
<meta name="description" content="Arcade Studio is the ultimate creative tool. Create custom frames, filters, generate fonts, convet video to GIFs, and symbols collection- all in one place.">

<style>
    /* --- GLOBAL SETTINGS & THEMES --- */
  html { 
      scroll-behavior: smooth; 
      overflow-y: auto; 
      background-color: #0a0a0c; /* <--- SAFETY NET: Prevents white bar glitches */
      height: 100%;
  }
  
  /* DEFAULT (ORIGINAL) THEME */
  body {
    background: #0a0a0c; color: white; font-family: sans-serif;
    display: flex; flex-direction: column; align-items: center;
    min-height: 100vh; margin: 0; padding-bottom: 150px; 
    -webkit-overflow-scrolling: touch; 
    background-image: linear-gradient(rgba(255,255,255,0.05) 1px, transparent 1px);
    background-size: 100% 4px; touch-action: pan-y; 
    transition: background 0.3s ease, color 0.3s ease;
  }
  /* --- ğŸ¨ NEW THEME: PRO TECH (Modern/Dark) --- */
  body.theme-pro {
      background-color: #000000;
      background-image: 
          radial-gradient(circle at 50% 30%, rgba(20, 40, 60, 0.4) 0%, transparent 60%),
          linear-gradient(rgba(0, 255, 255, 0.03) 1px, transparent 1px), 
          linear-gradient(90deg, rgba(0, 255, 255, 0.03) 1px, transparent 1px);
      background-size: 100% 100%, 50px 50px, 50px 50px;
  }
  body.theme-pro .btn { border-color: #00f3ff; color: #00f3ff; box-shadow: 0 0 8px rgba(0, 243, 255, 0.15); background: rgba(0,0,0,0.6); }
  body.theme-pro .menu-toggle { border-color: #00f3ff; color: #fff; background: rgba(0, 50, 60, 0.8); }
  body.theme-pro h1 { text-shadow: 0 0 15px rgba(0, 243, 255, 0.6); color: #fff; }

  /* --- ğŸ•¹ï¸ NEW THEME: CLASSIC ARCADE (Retro/Green) --- */
  body.theme-arcade {
      background-color: #111;
      background-image: radial-gradient(#1a1a1a 15%, transparent 16%), radial-gradient(#1a1a1a 15%, transparent 16%);
      background-size: 10px 10px;
      background-position: 0 0, 5px 5px;
  }
  body.theme-arcade .btn { border: 2px solid #00ff00; color: #00ff00; font-family: "Courier New", monospace; letter-spacing: 1px; }
  body.theme-arcade h1 { color: #00ff00; text-shadow: 4px 4px 0px #005500; }
  body.theme-arcade .menu-toggle { border: 2px solid #00ff00; color: #00ff00; }
  body.theme-arcade .studio-sec { border-left: 1px solid #003300; border-right: 1px solid #003300; padding: 10px; }
  /* --- ğŸŒ… NEW THEME: RETRO WAVE (80s/Purple) --- */
  body.theme-retro {
    background-color: #1a0022; /* <--- THIS paints the bottom gap Purple */
    background-image: linear-gradient(to bottom, #2b003b 0%, #1a0022 100%);
    background-attachment: fixed;
    background-size: cover;
    min-height: 100vh;
  }
  
  /* Retro Grid Floor Effect */
  body.theme-retro::before {
      content: ""; position: fixed; bottom: 0; left: 0; width: 100%; height: 40vh;
      background: linear-gradient(to top, rgba(255, 0, 255, 0.2) 1px, transparent 1px),
                  linear-gradient(90deg, rgba(255, 0, 255, 0.2) 1px, transparent 1px);
      background-size: 100% 20px, 40px 100%;
      transform: perspective(300px) rotateX(40deg);
      pointer-events: none; z-index: -1; opacity: 0.5;
  }
  body.theme-retro .btn { border-color: #ff00ff; color: #00ffff; background: rgba(20,0,20,0.6); }
  body.theme-retro h1 { 
      background: -webkit-linear-gradient(#00ffff, #ff00ff);
      -webkit-background-clip: text; -webkit-text-fill-color: transparent;
      text-shadow: 0 0 10px rgba(255,0,255,0.5);
  }
    /* FIX: Forces the "Root" to be Purple ONLY when Retro theme is active */
  html:has(body.theme-retro) {
    background-color: #1a0022 !important;
  } 
  /* --- âš ï¸ BROWSER DETECTION OVERLAY (NEW) --- */
  /* This hides by default and only shows if Plato/WebView is detected */
  #plato-overlay { 
      position: fixed; top: 0; left: 0; width: 100%; height: 100%; 
      background: rgba(10, 10, 12, 0.98); z-index: 999999; 
      display: none; flex-direction: column; align-items: center; justify-content: center; 
      text-align: center; padding: 30px; box-sizing: border-box; 
      backdrop-filter: blur(8px);
  }
  .plato-icon { font-size: 50px; margin-bottom: 20px; animation: bounce 1s infinite; }
  .plato-msg { color: #ff0000; font-family: "Arial Black", sans-serif; font-size: 22px; text-transform: uppercase; margin-bottom: 15px; text-shadow: 0 0 15px rgba(255,0,0,0.6); }
  .plato-desc { color: #eee; font-size: 13px; max-width: 320px; margin-bottom: 30px; line-height: 1.6; font-weight: bold; background: #222; padding: 15px; border-radius: 8px; border: 1px solid #444; }
  
  /* FIXED BUTTON STYLE: Blue/Teal (Initial State) */
  .plato-btn { 
      background: #004d4d; /* Deep Teal */
      color: #ffffff; 
      padding: 15px 25px; 
      border-radius: 8px; 
      font-weight: 900; 
      border: 2px solid #00ffff; /* Neon Cyan Border */
      font-size: 12px; 
      cursor: pointer; 
      text-transform: uppercase; 
      box-shadow: 0 0 15px rgba(0, 255, 255, 0.15); /* Blue Glow */
      text-decoration: none; 
      display: inline-block; 
      transition: background 0.2s, transform 0.1s;
  }
  .plato-btn:hover { background: #006666; }
  .plato-btn:active { background: #006666; transform: scale(0.95); }

  @keyframes bounce { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-10px); } }

  /* --- CUSTOM SCROLLBAR --- */
  ::-webkit-scrollbar { width: 12px; }
  ::-webkit-scrollbar-track { background: #0a0a0c; border-left: 1px solid #333; }
  ::-webkit-scrollbar-thumb { background: #333; border-radius: 6px; border: 2px solid #0a0a0c; }
  ::-webkit-scrollbar-thumb:hover { background: #00ffff; }

  /* --- âœ¨ NEW FEATURE: MAGIC FILTERS MENU CSS --- */
  #filter-wrapper { display: none; flex-direction: column; width: 100%; margin-top: 5px; background: #111; border: 1px solid #333; border-radius: 8px; padding: 10px; box-sizing: border-box; }
  #filter-wrapper.active { display: flex; animation: slideDown 0.3s ease; }
  
  .filter-scroll { display: flex; gap: 10px; overflow-x: auto; padding-bottom: 5px; scrollbar-width: none; -webkit-overflow-scrolling: touch; }
  .filter-scroll::-webkit-scrollbar { display: none; }
  .filter-btn { 
    flex: 0 0 70px; display: flex; flex-direction: column; align-items: center; gap: 5px;
    background: transparent; border: none; cursor: pointer; opacity: 0.7; transition: 0.2s;
  }
  .filter-btn:hover, .filter-btn.active-filter { opacity: 1; transform: scale(1.05); }
  .filter-btn.active-filter .filter-preview { border-color: #00ffff; box-shadow: 0 0 8px #00ffff; }
  
  .filter-preview { width: 60px; height: 60px; border-radius: 6px; border: 2px solid #444; object-fit: cover; background: #000; }
  .filter-name { color: #fff; font-size: 9px; font-weight: bold; text-transform: uppercase; letter-spacing: 0.5px; }
  
  @keyframes slideDown { from { opacity: 0; transform: translateY(-10px); } to { opacity: 1; transform: translateY(0); } }
  /* --- NAVIGATION BUTTONS --- */
  .menu-toggle { 
    position: absolute; 
    top: 15px; left: 15px;
    height: 38px; box-sizing: border-box;
    display: flex; align-items: center; justify-content: center;
    background: rgba(20, 20, 20, 0.6); 
    color: rgba(255, 255, 255, 0.9); 
    border: 1px solid rgba(255, 255, 255, 0.15); 
    backdrop-filter: blur(4px);
    padding: 0 12px; border-radius: 4px; font-weight: bold; cursor: pointer; 
    z-index: 100000; font-size: 12px; 
    box-shadow: 0 4px 6px rgba(0,0,0,0.3); 
    transition: transform 0.1s ease, background 0.2s;
    text-shadow: 0 0 5px rgba(255,255,255,0.2);
  }
  .menu-toggle:active { transform: scale(0.90); background: rgba(255, 255, 255, 0.1); border-color: #fff; }
  /* --- SIDEBAR MENU --- */
  #menu-panel { 
    position: fixed; top: 0; left: -260px; width: 240px; height: 100%; 
    background: #1a1a1c; padding-top: 60px; 
    transition: 0.3s cubic-bezier(0.4, 0, 0.2, 1); 
    z-index: 99999; display: flex; flex-direction: column; gap: 15px; 
    padding-left: 15px; padding-right: 15px; 
    box-shadow: 2px 0 15px rgba(0,0,0,0.5); 
    box-sizing: border-box; padding-bottom: 80px; 
  }
  #menu-panel.open { left: 0; }
  
  .switch-container { position: relative; width: 100%; }
  
  /* Shared style for Switch To and Theme buttons */
  #switch-btn, #theme-btn { 
    background: rgba(255,255,255,0.05); color: white; border: 2px solid #ff0000; 
    padding: 10px; border-radius: 4px; font-weight: bold; cursor: pointer; 
    font-size: 11px; text-transform: uppercase; width: 100%; text-align: center;
    box-shadow: 0 0 10px rgba(255,0,0,0.5); 
    transition: transform 0.1s ease;
  }
  #switch-btn:active, #theme-btn:active { transform: scale(0.95); background: rgba(255,0,0,0.2); }

  /* Submenus (Switch To & Theme) */
  #switch-menu, #theme-menu { 
    position: absolute; top: 45px; right: 0; background: #1a1a1c; 
    border: 1px solid #ff0000; border-radius: 8px; width: 210px; 
    display: none; flex-direction: column; overflow: hidden; 
    box-shadow: 0 10px 20px rgba(0,0,0,0.8); z-index: 100001;
  }
  #switch-menu button, #theme-menu button { 
    background: transparent; color: #aaa; border: none; padding: 14px; 
    text-align: left; font-weight: bold; font-size: 11px; cursor: pointer; 
    border-bottom: 1px solid rgba(255,255,255,0.05); text-transform: uppercase;
    transition: background 0.2s;
  }
  #switch-menu button:active, #theme-menu button:active { background: rgba(255,255,255,0.1); }
  /* Active Link Styles */
  #switch-menu button.active-link, #theme-menu button.active-link { 
      color: #00ffff; background: rgba(0,255,255,0.1); border-left: 3px solid #00ffff; 
  }

  .designed-by { position: absolute; bottom: 0; left: 0; width: 100%; padding: 20px 0; border-top: 1px solid rgba(255,255,255,0.1); text-align: center; font-size: 11px; font-weight: 900; color: #888; background: #1a1a1c; }
  .designed-by b { color: #ff0000; text-shadow: 0 0 8px rgba(255,0,0,0.6); }
  .music-section { border: 1px solid rgba(255,255,255,0.1); background: rgba(255,255,255,0.03); border-radius: 6px; padding: 10px; display: flex; flex-direction: column; gap: 8px; }
  .lnk { 
    display: flex; align-items: center; gap: 10px; padding: 12px; 
    text-decoration: none; color: white; font-size: 13px; font-weight: bold; 
    border-radius: 4px; border: 1px solid rgba(255,255,255,0.1); 
    background: rgba(255,255,255,0.05); 
    transition: transform 0.1s ease;
  }
  .lnk:active { transform: scale(0.96); background: rgba(255,255,255,0.1); }
  .lnk svg { width: 18px; height: 18px; fill: white; }
  
  /* HEADERS */
  h1 { color: #fff; margin: 60px 0 0 0; font-family: "Arial Black", sans-serif; font-style: italic; font-size: 36px; text-transform: uppercase; letter-spacing: -1px; text-shadow: 2px 2px 0px #ff0000, -1px -1px 10px rgba(255, 0, 0, 0.8); animation: arcadeBounce 1.8s infinite ease-in-out; }
  @keyframes arcadeBounce { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-10px); } }
  .sub { color: #fff; font-weight: bold; margin: 2px 0 15px 0; text-transform: uppercase; font-size: 11px; letter-spacing: 2px; text-align: center; }
  /* --- LAYOUT LOGIC --- */
  .studio-sec { display: none; width: 320px; flex-direction: column; align-items: center; }
  .active-sec { display: flex; }

  @media (min-width: 1024px) {
    body { justify-content: flex-start; padding-top: 40px; }
    .studio-sec { width: 90%; max-width: 1100px; flex-direction: row; align-items: flex-start; justify-content: center; gap: 60px; }
    #frame-studio, #gif-studio { align-items: center; }
    .ui, .ui-gif { width: 350px; margin-top: 0; }
    #font-studio { flex-direction: column; align-items: center; }
    #font-results { display: grid; grid-template-columns: repeat(3, 1fr); gap: 15px; max-height: 70vh; overflow-y: scroll; padding-right: 10px; }
    .font-input { width: 50%; }
    #sym-studio { flex-direction: column; align-items: center; }
    .sym-box-container { width: 50%; }
    #sym-container { max-height: 70vh; overflow-y: scroll; padding-right: 10px; width: 100%; }
    .sym-btn { flex: 1 0 50px; }
  }
  /* --- ğŸ–¼ï¸ FRAME STUDIO CSS --- */
  #box { position: relative; width: 310px; height: 310px; border-radius: 50%; overflow: hidden; border: 3px solid #ff0000; box-sizing: border-box; background: transparent; z-index: 10; flex-shrink: 0; }
  
  /* ğŸ› ï¸ TOUCH FIX: 'touch-action: none' enables 1-finger dragging on the canvas */
  canvas#c { position: absolute; top: 50%; left: 50%; width: 310px; height: 310px; transform: translate(-50%, -50%); z-index: 15; touch-action: none; }
  
  #frame-btn-group { display: flex; flex-direction: column; gap: 6px; width: 100%; }
  #ui-toggle-btn { margin-bottom: 6px; }

  .ui { margin-top: 20px; width: 310px; display: flex; flex-direction: column; gap: 6px; background: transparent; }
  
  .btn { 
    background: #000; border: 2px solid #fff; color: white; padding: 12px; 
    text-align: center; border-radius: 8px; font-weight: 900; 
    display: block; font-size: 12px; cursor: pointer; 
    text-transform: uppercase; width: 100%; box-sizing: border-box; 
    transition: transform 0.1s ease, border-color 0.2s, background 0.2s, box-shadow 0.2s;
  }
  .btn:active { transform: scale(0.95); opacity: 0.8; }
  .btn:disabled { opacity: 0.3; cursor: not-allowed; border-color: #555; color: #555; transform: none; }
  .btn-r { border-color: #ff0000; }
  .lbl { font-size: 9px; color: #888; text-transform: uppercase; margin-top: 2px; display: flex; justify-content: space-between; align-items: center; width: 100%; }
  .val-tag { color: #ff0000; font-weight: bold; font-family: monospace; font-size: 10px; }
  
  /* --- ğŸ›‘ SLIDER FIX (NO JUMP + SCROLL SAFETY) --- */
  input[type=range] { 
      -webkit-appearance: none; 
      width: 100%; 
      background: transparent; 
      margin: 10px 0; 
      cursor: pointer; 
      touch-action: pan-y; /* Allows scrolling over the slider */
      pointer-events: none; /* Disables clicking the track to jump */
  }
  input[type=range]::-webkit-slider-runnable-track { width: 100%; height: 8px; background: linear-gradient(to right, #ff0000 var(--v, 0%), #00ffff var(--v, 0%)); border-radius: 4px; }
  input[type=range]::-webkit-slider-thumb { 
      -webkit-appearance: none; 
      height: 20px; 
      width: 20px; 
      border-radius: 50%; 
      background: #ff0000; 
      margin-top: -6px; 
      border: 2px solid #ffffff; 
      box-shadow: 0 0 10px #ff0000; 
      pointer-events: auto; /* Re-enables dragging ONLY the circle */
  }
  /* --- ğŸ¨ PALETTE CSS --- */
  #palette-wrapper { display: none; flex-direction: column; width: 100%; margin-top: 5px; background: #000; border: 1px solid #333; border-radius: 8px; padding: 8px; box-sizing: border-box; }
  #palette-wrapper.active { display: flex; }
  
  .cat-scroll { display: flex; gap: 6px; overflow-x: auto; padding-bottom: 8px; margin-bottom: 5px; scrollbar-width: none; -webkit-overflow-scrolling: touch; }
  .cat-scroll::-webkit-scrollbar { display: none; }
  
  .cat-btn { 
    flex: 0 0 auto; padding: 8px 12px; background: #1a1a1c; 
    border: 1px solid #444; border-radius: 20px; 
    font-size: 10px; font-weight: bold; cursor: pointer; color: #aaa; 
    transition: 0.2s ease; display: flex; align-items: center; gap: 5px;
  }
  .cat-btn:hover { background: #333; }
  .cat-btn.active-cat { background: #fff; color: #000; border-color: #fff; box-shadow: 0 0 10px rgba(255,255,255,0.3); }

  .color-grid-container { display: none; grid-template-columns: repeat(auto-fill, minmax(32px, 1fr)); gap: 6px; max-height: 220px; overflow-y: auto; padding-top: 5px; }
  .color-grid-container.show { display: grid; animation: fadeIn 0.2s ease; }
  
  .c-sq { height: 32px; border-radius: 6px; cursor: pointer; border: 1px solid rgba(255,255,255,0.1); position: relative; box-sizing: border-box; }
  .c-sq:active { transform: scale(0.9); border-color: #fff; }
  .c-sq.is-metal { border: 1px solid #fff; }

  @keyframes fadeIn { from { opacity: 0; transform: translateY(-5px); } to { opacity: 1; transform: translateY(0); } }

  /* --- âœï¸ FONT STUDIO CSS --- */
  .font-input { width: 100%; background: #111; border: 2px solid #00ffff; color: #fff; padding: 15px; border-radius: 8px; font-weight: bold; text-align: center; margin-bottom: 15px; font-size: 16px; outline: none; box-sizing: border-box; }
  .font-scroll { width: 100%; max-height: 500px; overflow-y: auto; display: flex; flex-direction: column; border-radius: 8px; overflow-x: hidden; border: 1px solid rgba(255,255,255,0.1); box-sizing: border-box; touch-action: pan-y; }
  .font-item { background: #1a1a1c; border-bottom: 1px solid rgba(255,255,255,0.1); padding: 16px; width: 100%; text-align: center; cursor: pointer; color: #eee; font-size: 16px; white-space: pre-wrap; transition: transform 0.05s ease; }
  .font-item:active { transform: scale(0.98); background: #333; color: #fff; }
  /* --- âœ¨ SYMBOLS STUDIO CSS --- */
  .sym-box-container { width: 100%; margin-bottom: 15px; }
  .sym-input { width: 100%; background: #000; border: 1px solid #00ffff; color: #00ffff; padding: 12px; font-size: 18px; border-radius: 6px; text-align: center; box-sizing: border-box; outline: none; }
  .sym-input:focus { border-color: #ff00ff; box-shadow: 0 0 10px rgba(255,0,255,0.5); }
  .cat-title { width: 100%; color: #ff0000; font-size: 12px; font-weight: bold; margin: 20px 0 5px 0; text-transform: uppercase; padding-left: 5px; border-bottom: 1px solid rgba(255,0,0,0.2); padding-bottom: 5px; }
  .sym-grid { display: flex; flex-wrap: wrap; gap: 5px; width: 100%; padding: 5px; box-sizing: border-box; }
  .sym-btn { background: #1a1a1c; border: 1px solid #333; color: white; padding: 15px 0; font-size: 20px; border-radius: 6px; cursor: pointer; text-align: center; flex: 1 0 18%; min-width: 50px; transition: transform 0.05s ease; }
  .sym-btn:active { transform: scale(0.90); background: #ff0000; color: #000; }
  
  /* --- âš¡ GIF STUDIO CSS --- */
  @keyframes rotate { 100% { transform: rotate(360deg); } }
  
  /* ğŸ› ï¸ TOUCH FIX: 'touch-action: none' enables dragging for the GIF studio */
  .stage { position: relative; width: 320px; height: 320px; display: flex; align-items: center; justify-content: center; margin-bottom: 30px; touch-action: none; flex-shrink: 0; }
  
  .led-ring { position: absolute; inset: -15px; border-radius: 50%; background: conic-gradient(from 0deg, #00f3ff, #bc13fe, #ff0055, #00f3ff); animation: rotate 1.0s linear infinite; filter: blur(20px); z-index: 1; pointer-events: none; }
  
  /* ğŸ› ï¸ TOUCH FIX applied here too */
  .viewport { position: relative; z-index: 5; width: 100%; height: 100%; border-radius: 50%; overflow: hidden; background-color: #000; display: flex; justify-content: center; align-items: center; box-shadow: inset 0 0 20px #000; touch-action: none; }
  
  #v { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); pointer-events: none; will-change: transform; }
  #o { width: 100%; height: 100%; object-fit: contain; display: none; }
  
  .ui-gif { z-index: 10; background: transparent; padding: 25px; border-radius: 30px; width: 340px; border: none; margin-bottom: 20px; max-width: 90%; box-sizing: border-box; display: flex; flex-direction: column; align-items: center; }
  .label-row { display: flex; justify-content: space-between; font-size: 11px; color: #888; margin-bottom: 8px; font-weight: 600; width: 100%; }
  
  .ui-gif input[type="range"] { margin-bottom: 25px; -webkit-appearance: none; width: 100%; background: transparent; cursor: pointer; }
  .ui-gif input[type="range"]::-webkit-slider-runnable-track { background: #333; height: 6px; border-radius: 3px; }
  .ui-gif input[type="range"]::-webkit-slider-thumb { -webkit-appearance: none; height: 20px; width: 20px; border-radius: 50%; background: #00f3ff; box-shadow: 0 0 10px #00f3ff; border: 2px solid #fff; margin-top: -7px; }
  .ui-gif input[type="range"]:disabled { opacity: 0.3; cursor: not-allowed; }

  .status { margin-top: 20px; font-size: 14px; text-align: center; color: #00f3ff; font-weight: 600; opacity: 0; transition: 0.3s; height: 20px; }
  .status.active { opacity: 1; }
  
  .neon-wrap { position: relative; width: 100%; margin-top: 15px; padding: 3px; border-radius: 50px; overflow: hidden; box-sizing: border-box; display: inline-block; box-shadow: 0 0 15px rgba(0,0,0,0.5); }
  .neon-wrap::before { content: ''; position: absolute; top: -50%; left: -50%; width: 200%; height: 200%; z-index: 0; animation: rotate 3s linear infinite; pointer-events: none; }
  .neon-wrap.blue::before { background: conic-gradient(transparent, transparent, #00f3ff, #bc13fe, #ff0055, #00f3ff, transparent, transparent); }
  .neon-wrap.red { margin-top: 20px; }
  .neon-wrap.red::before { background: conic-gradient(transparent, transparent, #ff0000, #ff5500, transparent, transparent); }
  
  .btn-inner { position: relative; z-index: 10; display: block; width: 100%; background: #000; color: white; padding: 15px 0; border-radius: 46px; font-weight: 900; font-size: 14px; text-align: center; text-decoration: none; border: none; cursor: pointer; box-sizing: border-box; pointer-events: auto; text-transform: uppercase; transition: transform 0.1s ease, background 0.1s; }
  .btn-inner:active { transform: scale(0.95); background: #111; }
  .btn-inner:disabled { opacity: 0.5; color: #555; cursor: not-allowed; transform: none; }

  input[type=file], #yt-player { display: none; }
</style>
</head>
<body onclick="initAudio()">
<div id="plato-overlay">
  <div class="plato-icon">âš ï¸</div>
  <div class="plato-msg">Uploads Restricted</div>
  <div class="plato-desc">
    Plato's internal browser blocks access to your Photo Gallery.<br><br>
    To upload images, please open this page in <b>Chrome</b> or <b>Safari</b>.
  </div>
  <a id="plato-copy-btn" class="plato-btn" href="#" onclick="copyCurrentUrl(event)">Copy Link & Open Browser</a>
</div>
<button class="menu-toggle" onclick="toggleMenu(event)">MENU â˜°</button>

<div id="menu-panel">
  <div class="switch-container" style="margin-bottom: 10px;">
    <button id="theme-btn" onclick="toggleThemeMenu(event)">ğŸ¨ CHANGE THEME</button>
    <div id="theme-menu">
      <button onclick="setTheme('original')" class="active-link" id="th-original">Original (Dark)</button>
      <button onclick="setTheme('pro')" id="th-pro">Pro Tech (Blue)</button>
      <button onclick="setTheme('arcade')" id="th-arcade">Classic Arcade (Green)</button>
      <button onclick="setTheme('retro')" id="th-retro">Retro Wave (Purple)</button>
    </div>
  </div>

  <div class="switch-container">
    <button id="switch-btn" onclick="toggleSwitchMenu(event)">SWITCH TO ğŸ“‚</button>
    <div id="switch-menu">
      <button id="nav-frame" class="active-link" onclick="changeStudio('frame')">ğŸ–¼ï¸ Frame Studio</button>
      <button id="nav-font" onclick="changeStudio('font')">âœï¸ Font Generator</button>
      <button id="nav-gif" onclick="changeStudio('gif')">âš¡ GIF Maker</button>
      <button id="nav-sym" onclick="changeStudio('sym')">âœ¨ Symbols Studio</button>
    </div>
  </div>
  <div class="music-section">
    <div class="music-btn" style="display:flex; justify-content:space-between; font-size:12px; font-weight:bold; cursor:pointer;" onclick="toggleMusic()">
      <span>MUSIC PLAYER</span> <span id="m-status" style="color:#ff0000;">ON</span>
    </div>
    <select class="station-select" style="width:100%; margin-top:5px;" onchange="changeMusic(this.value)">
      <option value="jfKfPfyJRdk">Live Lofi Jazz</option>
      <option value="BrnDlRmW5hs">Nostalgic Lofi</option>
      <option value="tLYL_3NcJck">Cyber City Ambience</option>
      <option value="FKtzkolncnk">Night Drive 1985</option>
      <option value="_Ojv9Zu1IZY">1983 Arcade Feeling</option>
      <option value="OBoMLZTtqb8">Retro Systems Online</option>
      <option value="lT8JepVwxBQ">Echoes of the 80s</option>
      <option value="MedT9ECothA">Neon Streets Drive</option>
      <option value="eAdtqDV06Ho">Arcade After Midnight</option>
      <option value="2kzQ272Le8Q">Pixel Sunset Dreams</option>
      <option value="0qCL3Sz1--M">Retro Wave Escape</option>
      <option value="2UN1ZVbBelU">Blinding By The Lights Retro</option>
     <option value="iDVKMdnvgl8">Blinding By The Lights Slowed</option>
     <option value="9JMjZbIpmS8">The Weeknd Open Hearts</option>
     <option value="TNGsftqag6M">CRT Scanline Dreams</option>
     <option value="GedLli_YXEI">Final Insert Coin</option>
    </select>
  </div>
  
  <a href="https://discord.gg/ardc" target="_blank" class="lnk" style="border-color:#5865F2;"><svg viewBox="0 0 127.14 96.36"><path d="M107.7,8.07A105.15,105.15,0,0,0,81.47,0a72.06,72.06,0,0,0-3.36,6.83A97.68,97.68,0,0,0,49,6.83,72.37,72.37,0,0,0,45.64,0,105.89,105.89,0,0,0,19.39,8.09C2.79,32.65-1.71,56.6.54,80.21h0A105.73,105.73,0,0,0,32.71,96.36,77.11,77.11,0,0,0,39.6,85.25a68.42,68.42,0,0,1-10.85-5.18c.91-.66,1.8-1.34,2.66-2a75.57,75.57,0,0,0,64.32,0c.87.71,1.76,1.39,2.66,2a68.68,68.68,0,0,1-10.87,5.19,77,77,0,0,0,6.89,11.1A105.25,105.25,0,0,0,126.6,80.22c2.36-24.44-5.42-48.18-18.9-72.15ZM42.45,65.69C36.18,65.69,31,60,31,53s5-12.74,11.43-12.74S54,46,53.89,53,48.84,65.69,42.45,65.69Zm42.24,0C78.41,65.69,73.25,60,73.25,53s5-12.74,11.44-12.74S96.23,46,96.12,53,91.08,65.69,84.69,65.69Z"/></svg><span>Discord Server</span></a>
  <a href="https://platopedia.com/groups/arcade" target="_blank" class="lnk" style="border-color:#00ffff;"><svg viewBox="0 0 24 24"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-1 17.93c-3.95-.49-7-3.85-7-7.93 0-.62.08-1.21.21-1.79L9 15v1c0 1.1.9 2 2 2v1.93zm6.9-2.54c-.26-.81-1-1.39-1.9-1.39h-1v-3c0-.55-.45-1-1-1H8v-2h2c.55 0 1-.45 1-1V7h2c1.1 0 2-.9 2-2v-.41c2.93 1.19 5 4.06 5 7.41 0 2.08-.8 3.97-2.1 5.39z"/></svg><span>Arcade Website</span></a>
  <div class="designed-by">DESIGNED BY <b>RISK</b></div>
</div>
<div id="yt-player"></div>
<h1 id="studio-name">ARCADE</h1>
<p class="sub" id="studio-sub">FRAME STUDIO</p>
<div id="frame-studio" class="studio-sec active-sec">
  <div id="box"><canvas id="c" width="800" height="800"></canvas></div>
  <div class="ui">
    <button id="ui-toggle-btn" class="btn" style="border-color:#ffcc00; color:#ffcc00; margin-bottom:10px;" onclick="toggleFrameUI()">ğŸ‘ï¸ HIDE MENU BUTTONS</button>
    <div id="frame-btn-group">
        <label class="btn" onclick="playClick()">CHOOSE IMAGE<input type="file" id="u1" accept="image/*" onchange="handleFile(event)" style="display:none"></label>
        <label class="btn btn-r" onclick="playClick()">APPLY FRAME<input type="file" id="u2" accept="image/*" onchange="handleFrame(event)" style="display:none"></label>
        
        <button class="btn" style="border-color:#00ffff; color:#00ffff;" onclick="toggleFilterUI()">MAGIC FILTERS âœ¨</button>
        
        <div id="filter-wrapper">
            <div class="filter-scroll" id="filter-list">
                </div>
        </div>

        <button class="btn" style="border-color:#ffffff; color:#ffffff;" onclick="togglePaletteUI()">COLOR PALETTE ğŸ¨</button>
        
        <div id="palette-wrapper">
            <div class="cat-scroll">
                <button class="cat-btn" onclick="renderCat('Neon')">NEON</button>
                <button class="cat-btn" onclick="renderCat('Gradients')">GRADIENTS</button>
                <button class="cat-btn" onclick="renderCat('Basic')">BASIC</button>
                <button class="cat-btn" onclick="renderCat('Metallics')">METALLICS</button>
                <button class="cat-btn" onclick="renderCat('Grays')">GRAYS</button>
                <button class="cat-btn" onclick="renderCat('Reds')">REDS</button>
                <button class="cat-btn" onclick="renderCat('Oranges')">ORANGES</button>
                <button class="cat-btn" onclick="renderCat('Yellows')">YELLOWS</button>
                <button class="cat-btn" onclick="renderCat('Greens')">GREENS</button>
                <button class="cat-btn" onclick="renderCat('Cyans')">CYANS</button>
                <button class="cat-btn" onclick="renderCat('Blues')">BLUES</button>
                <button class="cat-btn" onclick="renderCat('Purples')">PURPLES</button>
                <button class="cat-btn" onclick="renderCat('Pinks')">PINKS</button>
            </div>
            <div id="color-grid" class="color-grid-container"></div>
        </div>

        <button id="lock-btn" class="btn" style="border-color:#00ff00; color:#00ff00;" onclick="toggleBoundaryLock()">BOUNDARY LOCK: ON ğŸ”’</button>
        <button class="btn" style="border-color:#00ffff; color:#00ffff;" onclick="centerSubject()">CENTER SUBJECT ğŸ¯</button>
        <button class="btn" style="border-color:#ff0000; color:#ff0000;" onclick="resetProject()">RESET PROJECT â†»</button>
    </div>

    <div class="lbl">ZOOM <span id="z-val" class="val-tag">100%</span></div>
    <input type="range" id="z" min="0.1" max="2.5" step="0.01" value="1" oninput="updateZ(this.value)">
    
    <div class="lbl">ROTATE <span id="r-val" class="val-tag">0Â°</span></div>
    <input type="range" id="r" min="0" max="360" step="1" value="0" oninput="updateR(this.value)">
    
    <div class="lbl"><span id="m-lbl">CIRCLE SIZE</span> <span id="m-val" class="val-tag">375px</span></div>
    <input type="range" id="m" min="300" max="400" step="1" value="375" oninput="updateM(this.value)">
    
    <button id="save" class="btn" onclick="downloadPic()" disabled>DOWNLOAD PICTURE</button>
  </div>
</div>
<div id="font-studio" class="studio-sec">
  <input type="text" id="font-input" class="font-input" placeholder="Type text here..." oninput="genFonts()">
  <div class="lbl">TAP TO COPY <span class="val-tag" id="font-count">0 STYLES</span></div>
  <div id="font-results" class="font-scroll"></div>
</div>
<div id="gif-studio" class="studio-sec">
    <div class="stage" id="stage">
        <div class="led-ring"></div>
        <div class="viewport" id="vp">
            <video id="v" muted playsinline loop></video>
            <img id="o">
        </div>
    </div>

    <div class="ui-gif" id="uiPanel">
        <div id="upWrapper" class="neon-wrap blue">
            <button class="btn-inner" id="upBtn" onclick="document.getElementById('gfInput').click()">UPLOAD YOUR VIDEO</button>
        </div>
        <input type="file" id="gfInput" accept="video/*" style="display:none">

        <div class="label-row" style="margin-top:20px;"><span>ZOOM / SCALE</span><span id="zv">100%</span></div>
        <input type="range" id="zoom" min="100" max="300" step="1" value="100">

        <div class="label-row"><span>PLAYBACK SPEED</span><span id="sv">1.0x</span></div>
        <input type="range" id="speed" min="0.5" max="3.0" step="0.1" value="1.0">

        <div id="goBox" class="neon-wrap blue">
            <button id="go" class="btn-inner" disabled>âš¡ CREATE HD GIF</button>
        </div>
        
        <div id="msg" class="status">Processing...</div>
        
        <div id="dlBox" class="neon-wrap blue" style="display:none;">
            <a id="dl" class="btn-inner">â¬‡ï¸ DOWNLOAD GIF</a>
        </div>

        <div id="resetBox" class="neon-wrap red" style="display:none;">
            <button class="btn-inner" onclick="resetGifProject()">â†» RESET PROJECT</button>
        </div>
    </div>
</div>

<div id="sym-studio" class="studio-sec">
    <div class="lbl">TAP SYMBOLS TO BUILD BIO</div>
    <div class="sym-box-container">
        <input type="text" id="sym-box" class="sym-input" placeholder="Type or tap symbols here...">
    </div>
    <div id="sym-container" class="font-scroll"></div>
</div>
<script src="https://www.youtube.com/iframe_api"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/gif.js/0.2.0/gif.js"></script>
<script>
// --- CORE VARIABLES ---
const c=document.getElementById('c'), x=c.getContext('2d');
const zSl=document.getElementById('z'), rSl=document.getElementById('r'), mSl=document.getElementById('m');
const panel=document.getElementById('menu-panel'), mStat=document.getElementById('m-status');
const sName=document.getElementById('studio-name'), sSub=document.getElementById('studio-sub');
const swMenu=document.getElementById('switch-menu'), thMenu=document.getElementById('theme-menu');
const zVal=document.getElementById('z-val'), rVal=document.getElementById('r-val'), mVal=document.getElementById('m-val');
const mLbl=document.getElementById('m-lbl'); 

let i=new Image(), f=new Image();
let cfg={s:1, m:375, x:400, y:400, r:0, lx:0, ly:0, pColor: null, pType: null, filter: 'none', adj: { b: 100, c: 100, s: 100 }}; 
let player, musicOn=true, audioStarted=false;
const audioCtx = new (window.AudioContext || window.webkitAudioContext)();

// --- âš ï¸ BROWSER DETECTION LOGIC ---
function detectPlato() {
    const ua = navigator.userAgent || navigator.vendor || window.opera;
    if (ua.indexOf("Plato") > -1 || ua.indexOf("wv") > -1 || (/iPhone|iPad|iPod/.test(ua) && !window.MSStream && !/Safari/.test(ua))) { 
        document.getElementById('plato-overlay').style.display = 'flex';
        document.body.style.overflow = 'hidden'; 
    }
}
function copyCurrentUrl(e) {
    e.preventDefault();
    navigator.clipboard.writeText(window.location.href).then(() => {
        e.target.innerText = "COPIED! OPEN CHROME/SAFARI";
        e.target.style.background = "#4a0000";       
        e.target.style.borderColor = "#ff0000";      
    });
}
detectPlato(); 

// --- SIDEBAR MENU & THEME LOGIC ---
function toggleMenu(e) { e.stopPropagation(); initAudio(); panel.classList.toggle('open'); playClick(); }
function toggleSwitchMenu(e) { e.stopPropagation(); swMenu.style.display = swMenu.style.display === 'flex' ? 'none' : 'flex'; thMenu.style.display = 'none'; playClick(); }
function toggleThemeMenu(e) { e.stopPropagation(); thMenu.style.display = thMenu.style.display === 'flex' ? 'none' : 'flex'; swMenu.style.display = 'none'; playClick(); }
// --- ğŸµ AUDIO ---
const playlist = ["jfKfPfyJRdk", "BrnDlRmW5hs", "tLYL_3NcJck", "FKtzkolncnk", "_Ojv9Zu1IZY", "OBoMLZTtqb8", "lT8JepVwxBQ", "MedT9ECothA", "eAdtqDV06Ho", "2kzQ272Le8Q", "0qCL3Sz1--M", "2UN1ZVbBelU", "iDVKMdnvgl8", "9JMjZbIpmS8", "TNGsftqag6M", "GedLli_YXEI"];
function initAudio(){ if(!audioStarted){ audioCtx.resume().then(()=>{ audioStarted=true; if(player&&musicOn){ player.unMute(); player.playVideo(); }});}}
function onYouTubeIframeAPIReady(){ const rId = playlist[Math.floor(Math.random() * playlist.length)]; const sel = document.querySelector('.station-select'); if(sel) sel.value = rId; player=new YT.Player('yt-player',{height:'0',width:'0',videoId:rId,playerVars:{'autoplay':1,'loop':1,'playlist':rId,'mute':0},events:{'onReady':e=>{e.target.setVolume(25);}}});}
function changeMusic(id){ if(player)player.loadVideoById(id); playShutter(); }
function toggleMusic(){ initAudio(); playClick(); musicOn=!musicOn; if(musicOn){ player.playVideo(); mStat.innerText="ON"; mStat.style.color="#ff0000"; }else{ player.pauseVideo(); mStat.innerText="OFF"; mStat.style.color="#888"; }}
function playClick(){ if(audioCtx.state!=='running')audioCtx.resume(); const o=audioCtx.createOscillator(), g=audioCtx.createGain(); o.frequency.setValueAtTime(800, audioCtx.currentTime); g.gain.setValueAtTime(0.03, audioCtx.currentTime); o.connect(g); g.connect(audioCtx.destination); o.start(); o.stop(audioCtx.currentTime+0.1); }
function playShutter(){ if(audioCtx.state!=='running')audioCtx.resume(); const o=audioCtx.createOscillator(), g=audioCtx.createGain(); o.type='square'; o.frequency.setValueAtTime(150, audioCtx.currentTime); g.gain.setValueAtTime(0.03, audioCtx.currentTime); o.connect(g); g.connect(audioCtx.destination); o.start(); o.stop(audioCtx.currentTime+0.1); }

// --- ğŸ¨ THEME ENGINE ---
function setTheme(theme) {
    document.body.classList.remove('theme-pro', 'theme-arcade', 'theme-retro');
    document.querySelectorAll('#theme-menu button').forEach(b => b.classList.remove('active-link'));
    if (theme === 'pro') { document.body.classList.add('theme-pro'); document.getElementById('th-pro').classList.add('active-link'); }
    else if (theme === 'arcade') { document.body.classList.add('theme-arcade'); document.getElementById('th-arcade').classList.add('active-link'); }
    else if (theme === 'retro') { document.body.classList.add('theme-retro'); document.getElementById('th-retro').classList.add('active-link'); }
    else { document.getElementById('th-original').classList.add('active-link'); }
    localStorage.setItem('arcadeTheme', theme); playClick();
}
const savedTheme = localStorage.getItem('arcadeTheme'); if (savedTheme) { setTheme(savedTheme); }

function changeStudio(mode) {
  playClick(); 
  document.querySelectorAll('.studio-sec').forEach(s => s.classList.remove('active-sec')); 
  swMenu.style.display = 'none'; thMenu.style.display = 'none'; panel.classList.remove('open'); 
  if(mode === 'frame') { document.getElementById('frame-studio').classList.add('active-sec'); sName.innerText = "ARCADE"; sSub.innerText = "FRAME STUDIO"; }
  else if(mode === 'font') { document.getElementById('font-studio').classList.add('active-sec'); sName.innerText = "FONTS"; sSub.innerText = "GENERATOR STUDIO"; }
  else if(mode === 'gif') { document.getElementById('gif-studio').classList.add('active-sec'); sName.innerText = "NEON"; sSub.innerText = "GIF STUDIO"; }
  else if(mode === 'sym') { document.getElementById('sym-studio').classList.add('active-sec'); sName.innerText = "SYMBOLS"; sSub.innerText = "STUDIO"; }
}

function toggleFrameUI() {
    const grp = document.getElementById('frame-btn-group'), btn = document.getElementById('ui-toggle-btn');
    if (window.getComputedStyle(grp).display === 'none') { grp.style.display = 'flex'; btn.innerHTML = "ğŸ‘ï¸ HIDE MENU BUTTONS"; btn.style.color = "#ffcc00"; btn.style.borderColor = "#ffcc00"; } 
    else { grp.style.display = 'none'; btn.innerHTML = "ğŸ‘ï¸ SHOW MENU BUTTONS"; btn.style.color = "#555"; btn.style.borderColor = "#555"; }
    playClick();
}
</script>
<script>
// --- âœï¸ FONTS LOGIC ---
const chars = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";
const alphas = [
  {m:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789"},
  {m:"ğ€ğğ‚ğƒğ„ğ…ğ†ğ‡ğˆğ‰ğŠğ‹ğŒğğğğğ‘ğ’ğ“ğ”ğ•ğ–ğ—ğ˜ğ™ğšğ›ğœğğğŸğ ğ¡ğ¢ğ£ğ¤ğ¥ğ¦ğ§ğ¨ğ©ğªğ«ğ¬ğ­ğ®ğ¯ï½—ğ±ğ²ğ³ğŸğŸğŸğŸ‘ğŸ’ğŸ“ğŸ”ğŸ•ğŸ–ğŸ—"},
  {m:"á—©á—·á‘•á—ªEá–´Gá•¼Iá’Ká’ªá—°á‘Oá‘­á‘«á–‡á”•Tá‘Œá¯á—¯á™­Yá˜”Î±á–¿ğ–¼ğ–½ğ–¾ğ–¿ğ—€ğ—ğ—‚ğ—ƒğ—„ğ—…ğ—†ğ—‡ğ—ˆğ—‰ğ—Šğ—‹ğ—Œğ—ğ—ğ—ğ—ğ—‘ğ—’ğ—“0123456789"},
  {m:"ğ‘¨ğ‘©ğ‘ªğ‘«ğ‘¬ğ‘­ğ‘®ğ‘¯ğ‘°ğ‘±ğ‘²ğ‘³ğ‘´ğ‘µğ‘¶ğ‘·ğ‘¸ğ‘¹ğ‘ºğ‘»ğ‘¼ğ‘½ğ‘¾ğ‘¿ğ’€ğ’ğ’‚ğ’ƒğ’„ğ’…ğ’†ğ’‡ğ’ˆğ’‰ğ’Šğ’‹ğ’Œğ’ğ’ğ’ğ’ğ’‘ğ’’ğ’“ğ’”ğ’•ğ’–ğ’—ğ’˜ğ’™ğ’šğ’›0123456789"},
  {m:"ï¼¡ï¼¢ï¼£ï¼¤ï¼¥ï¼¦ï¼§ï¼¨ï¼©ï¼ªï¼«ï¼¬ï¼­ï¼®ï¼¯ï¼°ï¼±ï¼²ï¼³ï¼´ï¼µï¼¶ï¼·ï¼¸ï¼¹ï¼ºï½ï½‚ï½ƒï½„ï½…ï½†ï½‡ï½ˆï½‰ï½Šï½‹ï½Œï½ï½ï½ï½ï½‘ï½’ï½“ï½”ï½•ï½–ï½—ï½˜ï½™ï½šï¼ï¼‘ğŸğŸ‘ï¼”ï¼•ï¼–ï¼—ï¼˜ï¼™"},
  {m:"â’¶â’·â’¸â’¹â’ºâ’»â’¼â’½â’¾â’¿â“€â“â“‚â“ƒâ“„â“…â“†â“‡â“ˆâ“‰â“Šâ“‹â“Œâ“â“â“â“â“‘â“’â““â“”â“•â“–â“—â“˜â“™â“šâ“›â“œâ“â“â“Ÿâ“ â“¡â“¢â“£â“¤â“¥â“¦â“§â“¨â“©â“ªâ‘ â‘¡â‘¢â‘£â‘¤â‘¥â‘¦â‘§â‘¨"},
  {m:"ğŸ…ğŸ…‘ğŸ…’ğŸ…“ğŸ…”ğŸ…•ğŸ…–ğŸ…—ğŸ…˜ğŸ…™ğŸ…šğŸ…›ğŸ…œğŸ…ğŸ…ğŸ…ŸğŸ… ğŸ…¡ğŸ…¢ğŸ…£ğŸ…¤ğŸ…¥ğŸ…¦ğŸ…§ğŸ…¨ğŸ…©ğŸ…ğŸ…‘ğŸ…’ğŸ…“ğŸ…”ğŸ…•ğŸ…–ğŸ…—ğŸ…˜ğŸ…™ğŸ…šğŸ…›ğŸ…œğŸ…ğŸ…ğŸ…ŸğŸ… ğŸ…¡ğŸ…¢ğŸ…£ğŸ…¤ğŸ…¥ğŸ…¦ğŸ…§ğŸ…¨ğŸ…©â“¿âŠâ‹âŒâââââ‘â’"},
  {m:"â’œâ’â’â’Ÿâ’ â’¡â’¢â’£â’¤â’¥â’¦â’§â’¨â’©â’ªâ’«â’¬â’­â’®â’¯â’°â’±â’²â’³â’´â’µâ’œâ’â’â’Ÿâ’ â’¡â’¢â’£â’¤â’¥â’¦â’§â’¨â’©â’ªâ’«â’¬â’­â’®â’¯â’°â’±â’²â’³â’´â’µ0123456789"},
  {m:"ğŸ„ğŸ„‘ğŸ„’ğŸ„“ğŸ„”ğŸ„•ğŸ„–ğŸ„—ğŸ„˜ğŸ„™ğŸ„šğŸ„›ğŸ„œğŸ„ğŸ„ğŸ„ŸğŸ„ ğŸ„¡ğŸ„¢ğŸ„£ğŸ„¤ğŸ„¥ğŸ„¦ğŸ„§ğŸ„¨ğŸ„©ğŸ„ğŸ„‘ğŸ„’ğŸ„“ğŸ„”ğŸ„•ğŸ„–ğŸ„—ğŸ„˜ğŸ„™ğŸ„šğŸ„›ğŸ„œğŸ„ğŸ„ğŸ„ŸğŸ„ ğŸ„¡ğŸ„¢ğŸ„£ğŸ„¤ğŸ„¥ğŸ„¦ğŸ„§ğŸ„¨ğŸ„©0123456789"},
  {m:"ğŸ…°ğŸ…±ğŸ…²ğŸ…³ğŸ…´ğŸ…µğŸ…¶ğŸ…·ğŸ…¸ğŸ…¹ğŸ…ºğŸ…»ğŸ…¼ğŸ…½ğŸ…¾ğŸ…¿ğŸ†€ğŸ†ğŸ†‚ğŸ†ƒğŸ†„ğŸ†…ğŸ††ğŸ†‡ğŸ†ˆğŸ†‰ğŸ…°ğŸ…±ğŸ…²ğŸ…³ğŸ…´ğŸ…µğŸ…¶ğŸ…·ğŸ…¸ğŸ…¹ğŸ…ºğŸ…»ğŸ…¼ğŸ…½ğŸ…¾ğŸ…¿ğŸ†€ğŸ†ğŸ†‚ğŸ†ƒğŸ†„ğŸ†…ğŸ††ğŸ†‡ğŸ†ˆğŸ†‰0123456789"},
  {m:"á´€Ê™á´„á´…á´‡êœ°É¢ÊœÉªá´Šá´‹ÊŸá´É´á´á´˜QÊ€êœ±á´›á´œá´ á´¡xÊá´¢á´€Ê™á´„á´…á´‡êœ°É¢ÊœÉªá´Šá´‹ÊŸá´É´á´á´˜QÊ€êœ±á´›á´œá´ á´¡xÊá´¢0123456789"},
  {m:"á´¬á´®á¶œá´°á´±á¶ á´³á´´á´µá´¶á´·á´¸á´¹á´ºá´¼á´¾á‘«á´¿Ë¢áµ€áµâ±½áµ‚Ë£Ê¸á¶»áµƒáµ‡á¶œáµˆáµ‰á¶ áµÊ°â±Ê²áµË¡áµâ¿áµ’áµ–qÊ³Ë¢áµ—áµ˜áµ›Ê·Ë£Ê¸á¶»0123456789"},
  {m:"ğ”¸ğ”¹â„‚ğ”»ğ”¼ğ”½ğ”¾â„ğ•€ğ•ğ•‚ğ•ƒğ•„â„•ğ•†â„™â„šâ„ğ•Šğ•‹ğ•Œğ•ğ•ğ•ğ•â„¤ğ•’ğ•“ğ•”ğ••ğ•–ğ•—ğ•˜ğ•™ğ•šğ•›ğ•œğ•ğ•ğ•Ÿğ• ğ•¡ğ•¢ğ•£ğ•¤ğ•¥ğ•¦ğ•§ğ•¨ğ•©ğ•ªğ•«ğŸ˜ğŸ™ğŸšğŸ›ğŸœğŸğŸğŸŸğŸ ğŸ¡"},
  {m:"ğ”„ğ”…â„­ğ”‡ğ”ˆğ”‰ğ”Šâ„Œâ„‘ğ”ğ”ğ”ğ”ğ”‘ğ”’ğ”“ğ””â„œğ”–ğ”—ğ”˜ğ”™ğ”šğ”›ğ”œâ„¨ğ”ğ”Ÿğ” ğ”¡ğ”¢ğ”£ğ”¤ğ”¥ğ”¦ğ”§ğ”¨ğ”©ğ”ªğ”«ğ”¬ğ”­ğ”®ğ”¯ğ”°Å§ğ”²ğ”³ğ”´ğ”µğ”¶ğ”·0123456789"},
  {m:"ğ•¬ğ•­ğ•®ğ•¯ğ•°ğ•±ğ•²ğ•³ğ•´ğ•µğ•¶ğ•·ğ•¸ğ•¹ğ•ºğ•»ğ•¼ğ•½ğ•¾ğ•¿ğ–€ğ–ğ–‚ğ–ƒğ–„ğ–…ğ–†ğ–‡ğ–ˆğ–‰ğ–Šğ–‹ğ–Œğ–ğ–ğ–ğ–ğ–‘ğ–’ğ–“ğ–”ğ–•ğ––ğ–—ğ–˜ğ–™ğ–šğ–›ğ–œğ–ğ–ğ–Ÿ0123456789"},
  {m:"â‚³à¸¿â‚µÄÉ†â‚£â‚²â±§Å‚Jâ‚­â± â‚¥â‚¦Ã˜â‚±Qâ±¤â‚´â‚®É„Vâ‚©Ó¾Éâ±«â‚³à¸¿â‚µÄÉ†â‚£â‚²â±§Å‚Jâ‚­â± â‚¥â‚¦Ã˜â‚±Qâ±¤â‚´â‚®É„Vâ‚©Ó¾Éâ±«0123456789"},
  {m:"ÈºÆ€Ã§ÄÉ‡fÇ¤Ä§É¨É‰êÅ‚mNÃ¸áµ½ê—ÉsÅ§áµ¾vwxyÆµÈºÆ€Ã§ÄÉ‡fÇ¤Ä§É¨É‰êÅ‚mNÃ¸áµ½ê—ÉsÅ§áµ¾vwxyÆµ0123456789"},
  {m:"Î±Ğ²câˆ‚Ñ”Æ’gĞ½Î¹× Ğºâ„“Ğ¼Ğ¸ÏƒÏqÑÑ•Ñ‚Ï…Î½Ï‰Ï‡ÑƒzÎ±Ğ²câˆ‚Ñ”Æ’gĞ½Î¹× Ğºâ„“Ğ¼Ğ¸ÏƒÏqÑÑ•Ñ‚Ï…Î½Ï‰Ï‡Ñƒz0123456789"},
  {m:"ğ€ğğ‚ğƒğ„ğ…ğ†ğ‡ğˆğ‰ğŠğ‹ğŒğğğğğ‘ğ’ğ“ğ”ğ•ğ–ğ—ğ˜ğ™abcdefghijklmnopqrstuvwxyz0123456789"},
  {m:"ğ‘¨ğ‘©ğ‘ªğ‘«ğ‘¬ğ‘­ğ‘®ğ‘¯ğ‘°ğ‘±ğ‘²ğ‘³ğ‘´ğ‘µğ‘¶ğ‘·ğ‘¸ğ‘¹ğ‘ºğ‘»ğ‘¼ğ‘½ğ‘¾ğ‘¿ğ’€ğ’abcdefghijklmnopqrstuvwxyz0123456789"},
  {m:"ğ’œâ„¬ğ’ğ’Ÿâ„°â„±ğ’¢â„‹â„ğ’¥ğ’¦â„’â„³â’©â’ªâ’«â’¬â„›ğ’®ğ’¯ğ’°â’±â’²â’³â’´â’µabcdefghijklmnopqrstuvwxyz0123456789"},
  {m:"ğ“ğ“‘ğ“’ğ““ğ“”ğ“•ğ“–ğ“—ğ“˜ğ“™ğ“šğ“›ğ“œğ“ğ“ğ“Ÿğ“ ğ“¡ğ“¢ğ“£ğ“¤ğ“¥ğ“¦ğ“§ğ“¨ğ“©abcdefghijklmnopqrstuvwxyz0123456789"},
  {m:"ğ– ğ–¡ğ–¢ğ–£ğ–¤ğ–¥ğ–¦ğ–§ğ–¨ğ–©ğ–ªğ–«ğ–¬ğ–­ğ–®ğ–¯ğ–°ğ–±ğ–²ğ–³ğ–´ğ–µğ–¶ğ–·ğ–¸ğ–¹abcdefghijklmnopqrstuvwxyz0123456789"},
  {m:"ğ—”ğ—•ï¼£ğ——ï¼¥ï¼¦ï¼§ï¼¨ï¼©ï¼ªï¼«ï¼¬ï¼­ï¼®ï¼¯ï¼°ğ—¤ğ—¥ğ—¦ï¼´ğ—¨ğ—©ğ—ªğ—«ğ—¬ğ—­abcdefghijklmnopqrstuvwxyz0123456789"},
  {m:"ğ˜ˆğ˜‰ğ˜Šğ˜‹ğ˜Œğ˜ğ˜ğ˜ğ˜ğ˜‘ğ˜’ğ˜“ğ˜”ğ˜•ğ˜–ğ˜—ğ˜˜ğ˜™ğ˜šğ˜›ğ˜œğ˜ğ˜ğ˜Ÿğ˜ ğ˜¡abcdefghijklmnopqrstuvwxyz0123456789"},
  {m:"ğ™°ğ™±ğ™²ğ™³ğ™´ğ™µğ™¶ğ™·ğ™¸ğ™¹ğ™ºğ™»ğ™¼ğ™½ğ™¾ğ™¿ğš€ğšğš‚ğšƒğš„ğš…ğš†ğš‡ğšˆğš‰abcdefghijklmnopqrstuvwxyz0123456789"},
  {m:"ğ”„ğ”…â„­ğ”‡ğ”ˆğ”‰ğ”Šâ„Œâ„‘ğ”ğ”ğ”ğ”ğ”‘ğ”’ğ”“ğ””â„œğ”–ğ”—ğ”˜ğ”™ğ”šğ”›ğ”œâ„¨abcdefghijklmnopqrstuvwxyz0123456789"},
  {m:"ğ•¬ğ•­ğ•®ğ•¯ğ•°ğ•±ğ•²ğ•³ğ•´ğ•µğ•¶ğ•·ğ•¸ğ•¹ğ•ºğ•»ğ•¼ğ•½ğ•¾ğ•¿ğ–€ğ–ğ–‚ğ–ƒğ–„ğ–…abcdefghijklmnopqrstuvwxyz0123456789"},
  {m:"ğ”¸ğ”¹â„‚ğ”»ğ”¼ğ”½ğ”¾â„ğ•€ğ•ğ•‚ğ•ƒğ•„â„•ğ•†â„™â„šâ„ğ•Šğ•‹ğ•Œğ•ğ•ğ•ğ•â„¤abcdefghijklmnopqrstuvwxyz0123456789"},
  {m:"ï¼¡ï¼¢ï¼£ï¼¤ï¼¥ï¼¦ï¼§ï¼¨ï¼©ï¼ªï¼«ï¼¬ï¼­ï¼®ï¼¯ï¼°ï¼±ï¼²ï¼³ï¼´ï¼µï¼¶ï¼·ï¼¸ï¼¹ï¼ºabcdefghijklmnopqrstuvwxyz0123456789"},
  {m:"á—©á—·á‘•á—ªEá–´Gá•¼Iá’Ká’ªá—°á‘Oá‘­á‘«á–‡á”•Tá‘Œá¯á—¯á™­Yá˜”abcdefghijklmnopqrstuvwxyz0123456789"},
  {m:"Î›BCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789"},
  {m:"ÈºÆÆ‡ÆŠÉ†Æ‘Æ“Ä¦ÉªÊÒ Åâ±®È Ã˜â±£ê–ÉŒÅÅ¦É„VÅ´Ó¾ÉÆµabcdefghijklmnopqrstuvwxyz0123456789"},
  {m:"ğ™°ğ™±ğ™²ğ™³ğ™´ğ™µğ™¶ğ™·ğ™¸ğ™¹ğ™ºğ™»ğ™¼ğ™½ğ™¾ğ™¿ğš€ğšğš‚ğšƒğš„ğš…ğš†ğš‡ğšˆğš‰ğšŠğš‹ğšŒğšğšğšğšğš‘ğš’ğš“ğš”ğš•ğš–ğš—ğš˜ğš™ğššğš›ğšœğ˜µğšğ‘£ğš ğš¡ğš¢ğš£ğŸ¶ğŸ·ğŸ¸ğŸ¹ğŸºğŸ»ğŸ¼ğŸ½ğŸ¾ğŸ¿"},
  {m:"ğ€ğğ‚ğƒğ„ğ…ğ†ğ‡ğˆğ‰ğŠğ‹ğŒğğğğğ‘ğ’ğ“ğ”ğ•ğ–ğ—ğ˜ğ™ğšğ›ğœğğğŸğ ğ¡ğ¢ğ£ğ¤ğ¥ğ¦ğ§ğ¨ğ©ğªğ«ğ¬ğ­ğ®ğ¯ğ°ğ±ğ²ğ³ğŸğŸğŸğŸ‘ğŸ’ğŸ“ğŸ”ğŸ•ğŸ–ğŸ—"}, 
  {m:"ğ‘¨ğ‘©ğ‘ªğ‘«ğ‘¬ğ‘­ğ‘®ğ‘¯ğ‘°ğ‘±ğ‘²ğ‘³ğ‘´ğ‘µğ‘¶ğ‘·ğ‘¸ğ‘¹ğ‘ºğ‘»ğ‘¼ğ‘½ğ‘¾ğ‘¿ğ’€ğ’ğ’‚ğ’ƒğ’„ğ’…ğ’†ğ’‡ğ’ˆğ’‰ğ’Šğ’‹ğ’Œğ’ğ’ğ’ğ’ğ’‘ğ’’ğ’“ğ’”ğ’•ğ’–ğ’—ğ’˜ğ’™ğ’šğ’›ğŸğŸğŸğŸ‘ğŸ’ğŸ“ğŸ”ğŸ•ğŸ–ğŸ—"}, 
 {m:"ğ˜¼ğ˜½ğ˜¾ğ˜¿ğ™€ğ™ğ™‚ğ™ƒğ™„ğ™…å¼€ğ™‡ğ™ˆğ™‰ğ™Šğ™‹ğ™Œğ™ğ™ğ™ğ™ğ™‘ğ™’ğ™“ğ™”ğ™•ğ™–ğ™—ğ™˜ğ™™ğ™šğ™›ğ™œğ™ğ™ğ™Ÿğ™ ğ™¡ğ™¢ğ™£ğ™¤ğ™¥ğ™¦ğ™§ğ™¨ğ™©ğ™ªğ™«ğ™¬ğ™­ğ™®ğ™¯ğŸ¬ğŸ­ğŸ®ğŸ¯ğŸ°ğŸ±ğŸ²ğŸ³ğŸ´9"},  
 {m:"á´¬Ê™á´„á´…á´‡Ò“É¢ÊœÉªá´Šá´‹ÊŸá´É´á´á´˜qÊ€sá´›á´œá´ á´¡xÊá´¢abcdefghijklmnopqrstuvwxyz0123456789"}
];

function genFonts(){
  const val=document.getElementById('font-input').value, resBox=document.getElementById('font-results'); resBox.innerHTML=""; if(!val)return;
  let count=0; alphas.forEach(alph=>{ let txt=""; const mapArr=Array.from(alph.m); for(let char of val){ let idx=chars.indexOf(char); txt+=(idx!==-1&&mapArr[idx])?mapArr[idx]:char; }
  let d=document.createElement('div'); d.className="font-item"; d.innerText=txt; d.onclick=()=>{navigator.clipboard.writeText(txt);playShutter();}; resBox.appendChild(d); count++; });
  document.getElementById('font-count').innerText=count+" STYLES";
}
const symData = {
    "Hearts": ["Ö¶Ö¢Ö¸","áµ•Ìˆ","â£ï¸","-'â™¡'-","á¥«á­¡","ã€‚â™¡","Ì†Ìˆ","â™¡ï¸","á¢‰ğ­©","á¥«á­¡.","Ë—Ë‹Ë â™¡ ËËŠË—","Ëšâ‚ŠÂ· ÍŸÍŸÍÍâ³â¥","ğ–¨†â™¡ğ–¨†","Ù€Ù€Ù€Ù€Ù€Ù€Ù€Ù€Ù€Ù€Ù€Ù€Ù€Ù€Ù€ï®©Ù¨Ù€â¤ï¸ï¸","â™¡ áª²áª²áª²","ğŸ–¤âƒğŸ¦‹","ğ€¶"],
    "Sparkles & Stars": [".ğ–¥” İ Ë–","à¼˜â‹†","â”€â”€","â‹†â‹…â˜†â‹…â‹†","â”€â”€","*à©ˆâœ©â€§â‚ŠËš","â‹†Ë™âŸ¡","â‹†.ğ™š ÌŠ","Ë™â‹†âœ®","á¯“â˜…","Ë™â‹†âœ®ê©œ","âœ®â‹†Ë™","âœ¨","â˜…","â˜†","âœ¡","âœ¦","âœ§","âœ©","âœª","âœ«","âœ¬","âœ­","âœ®","âœ¯","âœ°","â‚","â","â‘","âœ¢","âœ£","âœ¤","âœ¥","âœ±","âœ²","âœ³","âœ´","âœµ","âœ¶","âœ·","âœ¸","âœ¹","âœº","âœ»","âœ¼","âœ½","âœ¾","âœ¿","â€","â","â‚","âƒ","â„","â…","â†","â‡","âˆ","â‰","âŠ","â‹"],
    "Hanging Stars": ["*Ì£Ì¥â˜†Â·Í™Ì¥","â€§Í™âºËš*ï½¥à¼“â˜¾","â˜½à¼“ï½¥*Ëšâºâ€§Í™","â˜…*","*â˜…","â˜†.","Â¸.Â·","Â·.Â¸"],
    "Arrows": ["â†","â†’","â†“","â†‘","â†–","â†—","â†˜","â†™","â†”","â†•","â†š","â†›","â†œ","â†","â†","â†Ÿ","â† ","â†¡","â†¢","â†£","â†¤","â†¥","â†¦","â†§","â†¨","â†©","â†ª","â†«","â†¬","â†­","â†®","â†¯","â†°","â†±","â†²","â†³","â†´","â†¶","â†·","â†¸","â†¹","â†º","â†»","â†¼","â†½","â†¾","â†¿","â‡€","â‡","â‡‚","â‡ƒ","â‡„","â‡…","â‡†","â‡‡","â‡ˆ","â‡‰","â‡Š","â‡‹","â‡Œ","â‡","â‡","â‡","â‡•","â‡–","â‡—","â‡˜","â‡™","â‡š","â‡›","â‡œ","â‡","â‡","â‡Ÿ","â‡ ","â‡¡","â‡¢","â‡£","â‡¤","â‡¥","â‡¦","â‡§","â‡¨","â‡©","â‡ª","âŒ…","âŒ†","âŒ¤","â","â–¶","â˜‡","â˜ˆ","â˜Š","â˜‹","â˜Œ","â˜","â”","â˜","â™","âš","â›","âœ","â","â","âŸ","â ","â¡","â¢","â£","â¤","â¥","â¦","â§","â¨","â©","âª","â«","â¬","â­","â®","â¯","â±","â²","â³","â´","âµ","â¶","â·","â¸","â¹","âº","â»","â¼","â½","â¾","â¤´","â¤µ","â†µ","â‡°","â‡«","â‡¬","â‡­","â‡³","â‡®","â‡¯","â‡±","â‡²","â‡´","â‡µ","â‡·","â‡¸","â‡¹","â‡º","â‡‘","â‡“","â¤ª","â¤¨","â¤§","â¤©","â¤­","â¤®","â¤¯","â¤°","â¤±","â¤²","â¤«","â¤¬","â‡½","â‡¾","â‡¿","â¬³","âŸ¿","â¤‰","â¤ˆ","â‡»","â‡¼","â¬´","â¤€","â¬µ","â¤","â¬¹","â¤”","â¬º","â¤•","â¬¶","â¤…","â¬»","â¤–","â¬·","â¤","â¬¼","â¤—","â¬½","â¤˜","â¤","â¤","â¤Ÿ","â¤ ","â¤¡","â¤¢","â¤£","â¤¤","â¤¥","â¤¦","â¬","â¬","â¬‘","â¬","â¤¶","â¤·","â¥‚","â¥ƒ","â¥„","â­€","â¥±","â¥¶","â¥¸","â­‚","â­ˆ","â­Š","â¥µ","â­","â­‡","â­‰","â¥²","â­‹","â­Œ","â¥³","â¥´","â¥†","â¥…","â¥¹","â¥»","â¬°","â¥ˆ","â¬¾","â¥‡","â¬²","âŸ´","â¥·","â­ƒ","â¥º","â­„","â¥‰","â¥°","â¬¿","â¤³","â¥Š","â¥‹","â¥Œ","â¥","â¥","â¥","â¥","â¥‘","â¥’","â¥“","â¥”","â¥•","â¥–","â¥—","â¥¤","â¥£","â¥¥","â¥¦","â¥¨","â¥§","â¥©","â¥®","â¥¯","â¥ª","â¥¬","â¥«","â¥­","â¤Œ","â¤","â¤","â¤","â¬¸","â¤‘","âŸµ","âŸ¶","âŸ·","â¬…","â¬†","â¬‡","â¬ˆ","â¬‰","â¬Š","â¬‹","â¬Œ","â¬","â¬„","â¬€","â¬","â¬‚","â¬ƒ","âŸ»","âŸ¼","â¤’","â¤“","â¤™","â¤š","â¤›","â¤œ","â¥¼","â¥½","â¥¾","â¥¿","â¤¼","â¤½","â¤¾","â¤¿","â¤¸","â¤º","â¤¹","â¤»","â¥€","â¥","âŸ²","âŸ³","â¬±","âŸ¸","âŸ¹","âŸº","â¤‚","â¤ƒ","â¤„","â¤†","â¤‡","â¤Š","â¤‹","â‡","â‡’","â‡”","â‡¶","â­…","â­†","âŸ°","âŸ±"],
    "Astrological": ["â˜‰","âŠ•","â™","â˜½","â˜¿","â™€ï¸","â™‚ï¸","â™ƒ","â™„","â™…","â›¢","â™†","â¯“","â™‡","â¯”","â¯•","â¯–","ğŸŒ‘ï¸","ğŸŒ’ï¸","ğŸŒ“ï¸","ğŸŒ”ï¸","ğŸŒ•ï¸","ğŸŒ–ï¸","ğŸŒ—ï¸","ğŸŒ˜ï¸","âš³","âš´","âšµ","âš¶","â¯™","âš•","â¯š","âš·","â˜„ï¸","â¯°","â¯˜","â¯—","âŠ—","âš¸","â¯","â˜Š","â˜‹","â˜¿"],
    "Bracket": ["ï¼ˆ","ï¼‰","[","]","ã€","ã€‘","ã€","ã€","ã€Œ","ã€","ã€Š","ã€‹","ã€ˆ","ã€‰","ã€”","ã€•","ï¸¹","ï¸º","ï¸·","ï¸¸","ï¸µ","ï¸¶","ï¸»","ï¸¼","ï¸½","ï¸¾","ï¸¿","ï¹€","ï¹","ï¹‚","ï¹ƒ","ï¹„","ã››","ã™™","ã€–","ã€—","ï½›","ï½","ï¼œ","ï¼","ï¹¤","ï¹¥","ï¹™","ï¹š","ï¹","ï¹","ï¹›","ï¹œ","âŒ©","âŒª","Â«","Â»","â€¹","â€º"],
    "Check Marks": ["âœ“","âœ”","âœ”ï¸","âœ…","âœ˜","âœ—","â˜“","âˆ¨","âˆš","â˜","â˜’","â˜‘","ã¤¤","ã¤¥","âœ‡","ğŸ’¯","âŒ","â"],
    "Cross": ["âµœ","ğ¤•","ğ¤²","ğ“¶","â€ ","âœ","âœ","âœŸ","â˜¨","â˜¦","â™±","â˜¥","â™°","â€¡","âŠ¹","â˜©","âœ™"],
    "Email": ["âœ‰ï¸","ğŸ“¨","ğŸ“§","ğŸ’Œ","ğŸ“©","ğŸ“¥","ğŸ“¤","ğŸ“«","ğŸ“ª","ğŸ“¬","ğŸ“­","ğŸ“®","ğŸ“¦"],
    "Flowers": ["â","âƒ","â€","âœ¿","ğŸŒº","ğŸŒ¼","ğŸ€","ğŸŒ¸","ğŸŒ»","ğŸ’®","âœ¿","âš˜","âœ¾","âšœ","ğŸ’","ğŸŒ·","ğŸŒ¹","â˜˜","âœ¥","âœ¤","âœ£","âˆ","â‰","âŠ","â‡","â‹","âœ½","âœ»","âœ¼","ê•¤","ê•¥","ğŸµï¸","ê§","ê§‚","â•","ê™®","áª¥","Ö","ğŸ¥€","ğ“‡‹","ğ“™","ğ“†¹","ğ“‡‘","ğ“‹‡","ğ“‡—","ğ“‡š","ğ“†¸","ğ“‡Š","ğ“‡¬","ğ“†±","ğ“‡£","ğ“†¼","ğ“‡•","ğ“‡›","ğ“‡Ÿ","ğ“†­","ğ“†°","ğ“‹"],
    "Lines": ["â”ƒ","â•½","â•¿","â•","â•‘","â•","â”‡","ï¸±","â”Š","ï¸³","â”‹","â”†","â•µ","ã€¡","â•¹","â•»","â•·","ã€¢","ã££","â˜´","â˜µ","â˜¶","â˜·","â˜°","â˜±","â˜²","â˜³","ï¹‰","ï¹","ï¹Š","ï¹","â‰¡","â•","â”","â”€","â”„","â”ˆ","â•Œ","â•","â”…","â”‰","â•´","â•¶","â•¸","â•º","â•¼","â•¾","ï¸²","â‘†","â‘‡","â‘ˆ","â‘‰","â‘Š","â‘„","â‘€","ï¸´","ï¹","ï¹Œ","ï¹‹","â•²","â•±","ï¸¶","ï¸µ","ã€µ","ã€´","ã€†","`","áŸ","â€","âƒ","â¯"],
    "Music": ["â™©","â™ª","â™¬","â™«","â™­","â™®","â™¯","Â°","Ã¸","Ø‚","â‰ ","â‰­","ğŸ¶","ğŸµ","ğŸ¼","ğŸ¤","ğŸ§","ğŸ“»","ğŸ¸","ğŸ·","ğŸ¹","ğŸ»","ğŸº","ğŸ“£","ğŸ“¢","ğŸ”Š"],
    "Peace": ["âœŒ","âœ™","âœš","âœ›","âœœ","âœ","âœ","âœŸ","â€ ","âŠ¹","â€¡","â˜®","â˜¸","â˜¨","â˜©","â˜«","â˜¬","â˜­","â˜¯","â˜½","â˜¾","â™","âš”","â–","â†","â™…","âœ ","âœ¡","âœ¢","å","å","ã€·","â˜ ","â˜¢","â˜£","â˜¦","âš–"],
    "Punctuation": ["â€’","â€“","â€”","â€•","Â·","â€‘","â€–","â€ ","â€¡","â€°","â€±","Ê°","Ê±","Ê²","Ê³","Ê´","Êµ","Ê¶","Ê·","Ê¸","â€—","â€˜","â€™","â€š","â€›","â€œ","â€","â€","â€Ÿ","â€¢","â€£","â€¤","â€¥","â€¦","â€§","â€²","â€³","â€´","â€µ","â€¶","â€·","â›","âœ","â","â","Ê¹","Êº","Ê»","Ê¼","Ê½","Ê¾","Ê¿","Ë€","Ë","Ë‚","Ëƒ","Ë„","Ë…","Ë†","Ë‡","Ë","Ë‘","Ë’","Ë“","Ë”","Ë•","Ë–","Ë—","Ë˜","Ë™","Ëˆ","Ë‰","ËŠ","Ë‹","ËŒ","Ë","Ë","Ë","Ëš","Ë›","Ëœ","Ë","Ë ","ï½","Â¿","ã€ƒ","ã€","ã€","ï¸°","ï¼","ï¹","ï¹’","ï¹”","ï¹•","ï¼Œ","ï¼","ï¼š","ï¼›","ã€","ã€‚"],
    "Rectangle": ["â–","â–‚","â–ƒ","â–„","â–€","â–…","â–†","â–‡","â–‰","â–Š","â–‹","â–ˆ","â–Œ","â–","â–","â–","â–","â–•","â˜","â™","âš","â–”","â–¬","â–­","â–®","â–¯","â–‘","â–’","â–“"],
    "Time & Calendar": ["â°","ğŸ•","ğŸ•‘","ğŸ•’","ğŸ•“","ğŸ•”","ğŸ••","ğŸ•Ÿ","ğŸ• ","ğŸ•¡","ğŸ•¢","ğŸ•£","ğŸ•¤","ğŸ•¥","ğŸ•¦","ğŸ•–","ğŸ•—","ğŸ•˜","ğŸ•™","ğŸ•š","ğŸ•›","ğŸ•œ","ğŸ•","ğŸ•","â³","â§–","â§—","â‹ˆ","â§‘","â§’","â§“","â§”","â§•","âŒ›","ğŸ“…","ğŸ“†","ğŸ—“","âŒš","â±","ğ„"],
    "Degree & Weather": ["â›…","â˜€","â˜","ğŸŒ€","ğŸŒˆ","â˜‚","ğŸŒ‚","â˜”","â›„","ğŸ”¥","ğŸ’§","ğŸ’¦","ğŸŒŠ","ğŸŒ‘","ğŸŒ“","ğŸŒ”","ğŸŒ•","ğŸŒ™","ğŸŒ›","ğŸŒŒ","Â°","â„ƒ","â„‰","ÏŸ","âš¡","â˜ƒ","â˜‰","â˜¼","â˜½","â˜¾","â™","â™¨","â„","â…","â†","â˜‡","â˜ˆ","â˜„"],
    "Zodiac": ["â™ˆï¸","â™‰ï¸","â™Šï¸","â™‹ï¸","â™Œï¸","â™ï¸","â™ï¸","â™ï¸","â™ï¸","â™‘ï¸","â™’ï¸","â™“ï¸"],
    "Writing": ["âœ","âœ","âœï¸","âœ","ğŸ“","âœ’","âœ‘","âœ’ï¸","âœ‰","ğŸ”"],
    "Dividers": ["ã€°","ï¹","â€”","â”€","â”","â”‚","â”ƒ","â”„","â”…","â”†","â”‡","â”ˆ","â”‰","â”Š","â”‹","â•Œ","â•","â•","â•","â•","â•‘","â•’","â•“","â•”","â••","â•–","â•—","â•˜","â•™","â•š","â•›","â•œ","â•","â•","â•Ÿ","â• ","â•¡","â•¢","â•£","â•¤","â•¥","â•¦","â•§","â•¨","â•©","â•ª","â•«","â•¬"],
    "Borders": ["â•”","â•—","â•š","â•","â• ","â•£","â•","â•‘","â•¬","â•­","â•®","â•¯","â•°","â•±","â•²","â•³","â–","â–•","â––","â–—","â–˜","â–™","â–š","â–›","â–œ","â–","â–","â–Ÿ"],
    "Triangles": ["â–²","â–³","â–´","â–µ","â–¶","â–·","â–¸","â–¹","â–º","â–»","â–¼","â–½","â–¾","â–¿","â—€","â—","â—‚","â—ƒ","â—„","â—…","â—¢","â—£","â—¤","â—¥","â—¬","â—­","â—®"],
    "Circles & Dots": ["â€¢","â—‹","â—Œ","â—","â—","â—","â—","â—‘","â—’","â—“","â—”","â—•","â—–","â——","â—˜","â—™","â—š","â—›","â—œ","â—","â—","â—Ÿ","â— ","â—¡","â—¦","â—§","â—¨","â—©","â—ª","â—«","â—¯","â—°","â—±","â—²","â—³","â—´","â—µ","â—¶","â—·"],
    "Dice": ["âš€","âš","âš‚","âšƒ","âš„","âš…"],
    "Dominos": ["ğŸ€°","ğŸ€±","ğŸ€²","ğŸ€³","ğŸ€´","ğŸ€µ","ğŸ€¶","ğŸ€·","ğŸ€¸","ğŸ€¹","ğŸ€º","ğŸ€»","ğŸ€¼","ğŸ€½","ğŸ€¾","ğŸ€¿","ğŸ€","ğŸ","ğŸ‚","ğŸƒ","ğŸ„","ğŸ…","ğŸ†","ğŸ‡","ğŸˆ","ğŸ‰","ğŸŠ","ğŸ‹","ğŸŒ","ğŸ","ğŸ","ğŸ","ğŸ","ğŸ‘","ğŸ’","ğŸ“","ğŸ”","ğŸ•","ğŸ–","ğŸ—","ğŸ˜","ğŸ™","ğŸš","ğŸ›","ğŸœ","ğŸ","ğŸ","ğŸŸ","ğŸ ","ğŸ¡","ğŸ¢","ğŸ£","ğŸ¤","ğŸ¥","ğŸ¦","ğŸ§","ğŸ¨","ğŸ©","ğŸª","ğŸ«","ğŸ¬","ğŸ­","ğŸ®","ğŸ¯","ğŸ°","ğŸ±","ğŸ²","ğŸ³"],
    "Chess & Cards": ["â™”","â™•","â™–","â™—","â™˜","â™™","â™š","â™›","â™œ","â™","â™","â™Ÿ","â™ ","â™¡","â™¢","â™£","â™¤","â™¥","â™¦","â™§"],
    "Others": ["ï¾’à«¦ï¾’à«¦ğŸ’‹","â‹†.ËšğŸ¦‹à¼˜â‹†","â­‘.áŸ","à¼˜â‹†âœ¿","ğ”“","à£ª Ö´Ö¶Ö¸â˜¾.","á¯“á¡£ğ­©","â›ˆ","Ö¼ Ö¶Ö¸Ö¢.ğ“‚ƒâ˜‚â™¡","ê«‚â","â˜”ï¸ï¸","â‹†ï½¡ï¾Ÿâ˜ï¸ï½¡â‹†","â›†","ğ– š","â›¾","â™¨","ğ“","â˜•ï¸","ğ“Š¤","â€§â‚ŠËš â‹…","ğ“ğ“©","â€§â‚ŠËš â‹…","â‹†Ëšâœ¿Ë–Â°","ğŸ¤à¾€à½²à¾€à½²â˜•ï¸á°.áŸ","â‹†â˜•ï¸","Ë™âœ§Ë–Â°â˜•","à¼˜ â‹†ï½¡","â€§â‚ŠËš â‹…","â˜•ï¸","ğ“©","â€§â‚ŠËš â‹…"]
};
   function renderSymbols(){ const b=document.getElementById('sym-container'); b.innerHTML=""; for(const[c,s]of Object.entries(symData)){ let t=document.createElement('div'); t.className="cat-title"; t.innerText=c; b.appendChild(t); let g=document.createElement('div'); g.className="sym-grid"; s.forEach(sym=>{ let btn=document.createElement('div'); btn.className="sym-btn"; btn.innerText=sym; btn.onclick=()=>{ const tb=document.getElementById('sym-box'), st=tb.selectionStart, en=tb.selectionEnd; tb.value=tb.value.substring(0,st)+sym+tb.value.substring(en); tb.selectionStart=tb.selectionEnd=st+sym.length; playClick(); }; g.appendChild(btn); }); b.appendChild(g); } }
renderSymbols();
// --- ğŸŒˆ GRADIENT DEFINITIONS ---
const gradientDefs = {
    'grad-ruby': ['#FF512F', '#DD2476'], 'grad-red': ['#FF4B4B', '#C00000'], 'grad-crimson': ['#DC143C', '#8B0000'],
    'grad-rose': ['#FF80AB', '#C51162'], 'grad-hotpink': ['#FF69B4', '#C71585'], 'grad-magenta': ['#FF00FF', '#800080'],
    'grad-purple': ['#D080FF', '#7000A0'], 'grad-violet': ['#E040FB', '#7B1FA2'], 'grad-indigo': ['#7C4DFF', '#311B92'],
    'grad-midnight': ['#536DFE', '#1A237E'], 'grad-blue': ['#60C0FF', '#0050A0'], 'grad-azure': ['#448AFF', '#0D47A1'],
    'grad-sky': ['#40C4FF', '#01579B'], 'grad-cyan': ['#18FFFF', '#006064'], 'grad-teal': ['#64FFDA', '#004D40'],
    'grad-emerald': ['#69F0AE', '#1B5E20'], 'grad-green': ['#80E080', '#008000'], 'grad-lime': ['#EEFF41', '#827717'],
    'grad-yellow': ['#FFF080', '#DDAA00'], 'grad-amber': ['#FFD740', '#FF6F00'], 'grad-orange': ['#FFC060', '#D06000'],
    'grad-sunset': ['#FF512F', '#F09819'], 'grad-brown': ['#D7CCC8', '#5D4037'], 'grad-silver': ['#E0E0E0', '#606060'],
    'grad-slate': ['#90A4AE', '#37474F'], 'grad-charcoal': ['#616161', '#212121'], 'grad-black': ['#434343', '#000000']
};

// --- ğŸ¨ COLOR PALETTE DATA ---
const colorData = {
    'Neon': [
        {c:'#FFFFFF', t:'neon'}, {c:'#FEFEFE', t:'neon'}, {c:'#808080', t:'neon'}, {c:'#000000', t:'neon'},
        {c:'#FF0000', t:'neon'}, {c:'#dc143c', t:'neon'}, {c:'#ff4d4d', t:'neon'}, {c:'#ff6666', t:'neon'}, 
        {c:'#b22222', t:'neon'}, {c:'#800000', t:'neon'}, {c:'#5b0000', t:'neon'}, {c:'#fa8072', t:'neon'},
        {c:'#FFA500', t:'neon'}, {c:'#FF4500', t:'neon'}, {c:'#FF8C00', t:'neon'}, {c:'#f4a460', t:'neon'},
        {c:'#d2691e', t:'neon'}, {c:'#a0522d', t:'neon'}, {c:'#8b4500', t:'neon'},
        {c:'#FFD700', t:'neon'}, {c:'#ffff33', t:'neon'}, {c:'#f0e68c', t:'neon'}, {c:'#b8860b', t:'neon'}, {c:'#daa520', t:'neon'},
        {c:'#00FF00', t:'neon'}, {c:'#32cd32', t:'neon'}, {c:'#00FA9A', t:'neon'}, {c:'#7FFF00', t:'neon'}, 
        {c:'#ADFF2F', t:'neon'}, {c:'#90ee90', t:'neon'}, {c:'#2e8b57', t:'neon'}, {c:'#008000', t:'neon'},
        {c:'#006400', t:'neon'}, {c:'#228b22', t:'neon'},
        {c:'#00FFFF', t:'neon'}, {c:'#00CED1', t:'neon'}, {c:'#40e0d0', t:'neon'}, {c:'#7fffd4', t:'neon'},
        {c:'#afeeee', t:'neon'}, {c:'#008b8b', t:'neon'}, {c:'#008080', t:'neon'},
        {c:'#0000FF', t:'neon'}, {c:'#1E90FF', t:'neon'}, {c:'#4169E1', t:'neon'}, {c:'#0000CD', t:'neon'},
        {c:'#00008B', t:'neon'}, {c:'#000080', t:'neon'}, {c:'#87cefa', t:'neon'}, {c:'#b0c4de', t:'neon'},
        {c:'#FF00FF', t:'neon'}, {c:'#800080', t:'neon'}, {c:'#9400D3', t:'neon'}, {c:'#BA55D3', t:'neon'},
        {c:'#8b008b', t:'neon'}, {c:'#4b0082', t:'neon'}, {c:'#9932cc', t:'neon'}, {c:'#dda0dd', t:'neon'},
        {c:'#FF1493', t:'neon'}, {c:'#FF69B4', t:'neon'}, {c:'#db7093', t:'neon'}, {c:'#ffb6c1', t:'neon'},
        {c:'#c71585', t:'neon'}, {c:'#8b0000', t:'neon'},
        {c:'#C0C0C0', t:'neon'}, {c:'#A52A2A', t:'neon'}, {c:'#808080', t:'neon'}, {c:'#333333', t:'neon'}
    ],
    'Gradients': [
        {c:'#FF512F', t:'grad-ruby'}, {c:'#FF4B4B', t:'grad-red'}, {c:'#DC143C', t:'grad-crimson'},
        {c:'#FF80AB', t:'grad-rose'}, {c:'#FF69B4', t:'grad-hotpink'}, {c:'#FF00FF', t:'grad-magenta'},
        {c:'#D080FF', t:'grad-purple'}, {c:'#E040FB', t:'grad-violet'}, {c:'#7C4DFF', t:'grad-indigo'},
        {c:'#536DFE', t:'grad-midnight'}, {c:'#60C0FF', t:'grad-blue'}, {c:'#448AFF', t:'grad-azure'},
        {c:'#40C4FF', t:'grad-sky'}, {c:'#18FFFF', t:'grad-cyan'}, {c:'#64FFDA', t:'grad-teal'},
        {c:'#69F0AE', t:'grad-emerald'}, {c:'#80E080', t:'grad-green'}, {c:'#EEFF41', t:'grad-lime'},
        {c:'#FFF080', t:'grad-yellow'}, {c:'#FFD740', t:'grad-amber'}, {c:'#FFC060', t:'grad-orange'},
        {c:'#FF512F', t:'grad-sunset'}, {c:'#D7CCC8', t:'grad-brown'}, {c:'#E0E0E0', t:'grad-silver'},
        {c:'#90A4AE', t:'grad-slate'}, {c:'#616161', t:'grad-charcoal'}, {c:'#000000', t:'grad-black'}
    ],
    'Basic': [ {c:'#000000'}, {c:'#FFFFFF'}, {c:'#FF0000'}, {c:'#00FF00'}, {c:'#0000FF'}, {c:'#FFFF00'}, {c:'#00FFFF'}, {c:'#FF00FF'}, {c:'#FFA500'}, {c:'#800080'}, {c:'#A52A2A'}, {c:'#808080'} ],
    'Metallics': [ {c:'#FFD700', t:'gold'}, {c:'#C0C0C0', t:'silver'}, {c:'#CD7F32', t:'bronze'}, {c:'#D4AF37', t:'gold'}, {c:'#B8860B', t:'gold'}, {c:'#E5E4E2', t:'silver'} ],
    'Grays': [ {c:'#000000'}, {c:'#1a1a1a'}, {c:'#333333'}, {c:'#4d4d4d'}, {c:'#666666'}, {c:'#808080'}, {c:'#999999'}, {c:'#b3b3b3'}, {c:'#cccccc'}, {c:'#e6e6e6'}, {c:'#ffffff'} ],
    'Reds': [ {c:'#5b0000'}, {c:'#800000'}, {c:'#a52a2a'}, {c:'#b22222'}, {c:'#dc143c'}, {c:'#ff0000'}, {c:'#ff4d4d'}, {c:'#ff6666'}, {c:'#fa8072'}, {c:'#e9967a'}, {c:'#ff6347'}, {c:'#cd5c5c'} ],
    'Oranges': [ {c:'#8b4500'}, {c:'#a0522d'}, {c:'#d2691e'}, {c:'#cd853f'}, {c:'#f4a460'}, {c:'#ff8c00'}, {c:'#ffa500'}, {c:'#ffb347'}, {c:'#ffcc80'}, {c:'#ffe5b4'} ],
    'Yellows': [ {c:'#ffd700'}, {c:'#daa520'}, {c:'#b8860b'}, {c:'#bdb76b'}, {c:'#f0e68c'}, {c:'#khaki'}, {c:'#ffff00'}, {c:'#ffff33'}, {c:'#ffff66'}, {c:'#ffff99'}, {c:'#lightyellow'}, {c:'#ffffe0'} ],
    'Greens': [ {c:'#006400'}, {c:'#008000'}, {c:'#228b22'}, {c:'#2e8b57'}, {c:'#3cb371'}, {c:'#32cd32'}, {c:'#00ff00'}, {c:'#7cfc00'}, {c:'#7fff00'}, {c:'#adff2f'}, {c:'#90ee90'}, {c:'#98fb98'}, {c:'#00fa9a'}, {c:'#00ff7f'}, {c:'#66cdaa'} ],
    'Cyans': [ {c:'#008080'}, {c:'#008b8b'}, {c:'#20b2aa'}, {c:'#48d1cc'}, {c:'#00ced1'}, {c:'#40e0d0'}, {c:'#00ffff'}, {c:'#00ffff'}, {c:'#7fffd4'}, {c:'#afeeee'}, {c:'#e0ffff'} ],
    'Blues': [ {c:'#000080'}, {c:'#00008b'}, {c:'#0000cd'}, {c:'#0000ff'}, {c:'#1e90ff'}, {c:'#4169e1'}, {c:'#6495ed'}, {c:'#add8e6'}, {c:'#add8e6'}, {c:'#b0c4de'}, {c:'#f0f8ff'} ],
    'Purples': [ {c:'#4b0082'}, {c:'#483d8b'}, {c:'#6a5acd'}, {c:'#7b68ee'}, {c:'#800080'}, {c:'#8b008b'}, {c:'#9400d3'}, {c:'#9932cc'}, {c:'#ba55d3'}, {c:'#dda0dd'}, {c:'#e6e6fa'} ],
    'Pinks': [ {c:'#8b0000'}, {c:'#c71585'}, {c:'#db7093'}, {c:'#ff1493'}, {c:'#ff69b4'}, {c:'#ffb6c1'}, {c:'#ffc0cb'}, {c:'#fff0f5'} ]
};

function togglePaletteUI() {
    const el = document.getElementById('palette-wrapper');
    const btn = document.querySelector("button[onclick='togglePaletteUI()']");
    if(el.style.display === 'flex') {
        el.style.display = 'none';
        btn.innerHTML = "COLOR PALETTE ğŸ¨";
        btn.style.color = "#ffffff"; btn.style.borderColor = "#ffffff";
    } else {
        el.style.display = 'flex';
        el.classList.add('active');
        btn.innerHTML = "CLOSE PALETTE âœ–";
        btn.style.color = "#ffcc00"; btn.style.borderColor = "#ffcc00";
        renderCat('Neon'); 
    }
    playClick();
}

function renderCat(cat) {
    playClick();
    document.querySelectorAll('.cat-btn').forEach(b => {
        b.classList.remove('active-cat');
        if(b.innerText === cat.toUpperCase()) b.classList.add('active-cat');
    });

    const grid = document.getElementById('color-grid');
    grid.innerHTML = '';
    grid.classList.remove('show');

    setTimeout(() => {
        const list = colorData[cat];
        list.forEach(item => {
            const d = document.createElement('div');
            d.className = 'c-sq';

            // 1. Visual Styles (Neon vs Metal vs Basic)
            if(item.t === 'neon') {
                d.style.backgroundColor = item.c;
                d.style.boxShadow = `0 0 10px ${item.c}`;
                d.style.border = '2px solid white';
            } else if (item.t && gradientDefs[item.t]) {
                d.classList.add('is-metal');
                const cols = gradientDefs[item.t];
                d.style.background = `linear-gradient(135deg, ${cols[0]}, ${cols[1]})`;
            } else if (item.t) {
                d.classList.add('is-metal');
                if(item.t==='gold') d.style.background = 'linear-gradient(135deg, #FFD700, #FDB931)';
                if(item.t==='silver') d.style.background = 'linear-gradient(135deg, #E0E0E0, #B0B0B0)';
                if(item.t==='bronze') d.style.background = 'linear-gradient(135deg, #CD7F32, #A0522D)';
            } else {
                d.style.backgroundColor = item.c;
            }

            // 2. Click Handler (The Fix is Here)
            d.onclick = () => {
                // Apply Color
                if(typeof setPlainFrame === 'function') {
                    setPlainFrame(item.c, item.t || null);
                } else {
                    cfg.pColor = item.c;
                    cfg.pType = item.t || null;
                    document.getElementById('u2').value = '';
                    f = new Image(); 
                }

                // ğŸ”¥ FORCE SIZE TO 375px (Fixes the bug)
                cfg.m = 375;
                mSl.value = 375;
                mVal.innerText = "375px";
                if(typeof updS === 'function') updS(mSl);

                d(); // Redraw
                playClick();
            };
            
            grid.appendChild(d);
        });
        grid.classList.add('show');
    }, 10);
}
function setPlainFrame(color, type=null) {
    f = new Image(); 
    document.getElementById('u2').value = ''; 
    cfg.pColor = color; 
    cfg.pType = type; 
    mLbl.innerText = "FRAME OPENING SIZE"; 
    d(); 
    playClick();
}
// --- ğŸ† THE ULTIMATE MASTER COLLECTION (330+ PRO LOOKS) ---
// Updated: January 17, 2026 - Added "Avant-Garde" & "Rare Optical" Series
// Protection: No sharpen() logic used; Hardware Accelerated

const magicFilters = [
    // --- ROW 1: AI ELITE QUALITY BOOSTERS ---
    { name: 'ORIGINAL', f: 'none' },
    { name: 'AI-ELITE-REMASTER ğŸ†', f: 'contrast(1.4) brightness(1.1) saturate(1.1) contrast(1.1)' },
    { name: 'AI-4K-ULTRA-ENHANCE ğŸ’', f: 'contrast(1.4) saturate(1.1) brightness(1.05) contrast(1.1)' },
    { name: 'AI-HDR-MAX-CLARITY', f: 'contrast(1.6) saturate(1.2) brightness(1.1) contrast(1.1)' },
    { name: 'AUTO-ENHANCE âœ¨', f: 'contrast(1.15) saturate(1.25) brightness(1.05) sepia(0.05)' },
    
    // --- ğŸ“± UNIVERSAL DEVICE COMPATIBILITY ---
    { name: 'UNI-CLEAN-VIEW', f: 'brightness(1.1) contrast(1.05) saturate(1.05)' },
    { name: 'UNI-WARM-MOBILE', f: 'sepia(0.15) saturate(1.2) contrast(1.1)' },

    // --- ğŸ’¿ NEW SLVR (SILVER) SERIES ---
// Extracted from screenshots: High-contrast, metallic monochrome looks.
    { name: 'SLVR1', f: 'grayscale(1) contrast(1.5) brightness(1.2)' },
    { name: 'SLVR2', f: 'grayscale(1) contrast(1.8) brightness(1.1)' },
    { name: 'SLVR3', f: 'grayscale(1) contrast(2) brightness(0.9)' },

// --- ğŸï¸ NEW MNCH (MONOCHROME) SERIES ---
// Extracted from screenshots: Varied black and white depths.
    { name: 'MNCH1', f: 'grayscale(1) brightness(1.1) contrast(1.1)' },
    { name: 'MNCH2', f: 'grayscale(1) contrast(1.5) brightness(0.8)' },
    { name: 'MNCH3', f: 'grayscale(1) contrast(1.3) sepia(0.1)' },
    { name: 'B&W LowCon', f: 'grayscale(1) contrast(0.8) brightness(1.2)' },

    // --- ğŸ“¸ PRO CAMERA COLOR SCIENCE (Official Looks) ---
    { name: 'CAM-CANON-L', f: 'contrast(1.1) saturate(1.15) brightness(1.05) hue-rotate(-5deg)' },
    { name: 'CAM-SONY-ALPHA', f: 'contrast(1.25) saturate(1.1) brightness(1.1) hue-rotate(2deg)' },
    { name: 'CAM-NIKON-Z', f: 'contrast(1.15) saturate(1.2) brightness(1.0) sepia(0.05)' },
    { name: 'CAM-LEICA-M', f: 'contrast(1.4) saturate(1.1) brightness(1.1) sepia(0.02)' },
    { name: 'CAM-FUJI-X', f: 'saturate(1.3) contrast(1.1) brightness(1.05) hue-rotate(-5deg)' },

// --- ğŸï¸ CLEAR & SHARP FILM STOCKS (High Fidelity) ---
    { name: 'FILM-EKTAR-100', f: 'contrast(1.3) saturate(1.4) brightness(1.05)' },
    { name: 'FILM-PORTRA-160', f: 'contrast(1.05) saturate(1.1) brightness(1.1) sepia(0.05)' },
    { name: 'FILM-CINESTILL-50', f: 'contrast(1.1) brightness(1.1) saturate(1.2) hue-rotate(-5deg)' },
    { name: 'FILM-PRO-400H', f: 'brightness(1.15) contrast(1.1) saturate(1.05) hue-rotate(5deg)' },
    { name: 'FILM-GOLD-200', f: 'sepia(0.1) saturate(1.3) contrast(1.1) brightness(1.1)' },

// --- ğŸ’ ULTRA-CLARITY & STUDIO SERIES ---
    { name: 'STUDIO-LIGHTING', f: 'brightness(1.2) contrast(1.1) saturate(1.05)' },
    { name: 'CRYSTAL-CLEAR', f: 'contrast(1.3) brightness(1.1) saturate(1.1)' },
    { name: 'HD-REALISM', f: 'contrast(1.2) saturate(1.25) brightness(1.05)' },
    { name: 'PURE-WHITE-BAL', f: 'brightness(1.1) contrast(1.05) saturate(0.95)' },
    { name: 'DEEP-DEFINITION', f: 'contrast(1.5) saturate(1.0) brightness(1.0)' },

// --- ğŸ•°ï¸ VINTAGE YEARS EXPANSION ---
// Extracted from screenshots: Faded, year-specific film simulations.
    { name: '1991', f: 'sepia(0.3) saturate(1.3) hue-rotate(-15deg) contrast(1.1)' },
    { name: '1992', f: 'sepia(0.4) brightness(1.1) contrast(0.9) saturate(1.1)' },
    { name: '1993', f: 'saturate(1.5) contrast(1.2) hue-rotate(5deg) sepia(0.1)' },
    { name: '1995', f: 'sepia(0.2) contrast(1.1) brightness(0.9) saturate(0.8)' },
    { name: '1996', f: 'grayscale(0.5) contrast(1.1) brightness(1.1) sepia(0.2)' },

// --- âœ¨ SPECIAL FX & REQUESTED FILTERS ---
// Includes requested Photobooth, Fx-1993, and extracted Holga 2.
    { name: 'Holga 2', f: 'contrast(1.4) saturate(1.5) hue-rotate(-20deg) sepia(0.2)' },
    { name: 'Photobooth', f: 'brightness(1.2) contrast(1.1) saturate(0.9) sepia(0.05)' },
    { name: 'Fx-1993', f: 'contrast(1.2) saturate(1.6) sepia(0.3) hue-rotate(-10deg) brightness(1.05)' },

    // --- ğŸ”¥ 2026 HOT & TRENDING ---
    { name: 'THROWBACK-2016', f: 'saturate(2.5) contrast(1.4) brightness(1.1) sepia(0.1)' },
    { name: 'LO-FI-VIBES', f: 'contrast(1.6) saturate(1.8) brightness(0.95) hue-rotate(-5deg)' },
    { name: 'CLEAN-AESTHETIC', f: 'brightness(1.2) contrast(0.85) saturate(1.1) sepia(0.02)' },
    { name: 'DARK-ACADEMIA-PRO', f: 'sepia(0.4) contrast(1.2) brightness(0.8) saturate(0.6)' },
    { name: 'EARTHY-BOHO', f: 'sepia(0.3) saturate(0.8) contrast(1.1) brightness(0.95)' },

    // --- ğŸ’° RICH & ELITE COLOR GRADES ---
    { name: 'ROYAL-GOLD-LUXURY', f: 'sepia(0.2) saturate(1.6) contrast(1.3) brightness(1.05) hue-rotate(-5deg)' },
    { name: 'DEEP-VELVET-COLOR', f: 'saturate(1.4) contrast(1.5) brightness(0.95) sepia(0.1)' },
    { name: 'OBSIDIAN-BLACK', f: 'grayscale(1) contrast(1.7) brightness(0.9) sepia(0.05)' },
    { name: 'VOGUE-EDITORIAL', f: 'contrast(1.3) brightness(1.1) saturate(0.8) sepia(0.1)' },
    { name: 'CINEMATIC-TEAL-RICH', f: 'hue-rotate(185deg) saturate(1.2) contrast(1.4) brightness(0.9) sepia(0.1)' },
    { name: 'VIVID-OPULENCE', f: 'saturate(2.5) contrast(1.3) brightness(1.05) hue-rotate(-5deg)' },
    { name: 'MOODY-OAK-FILM', f: 'sepia(0.4) contrast(1.2) brightness(0.85) saturate(1.1)' },

    // --- ROW 3: ORIGINAL SCREENSHOT FILM COLLECTION ---
    { name: 'FILM-1', f: 'contrast(1.1) saturate(1.5) brightness(0.9)' },
    { name: 'FILM-2', f: 'sepia(0.2) contrast(1.2) brightness(1.1)' },
    { name: 'FILM-B&W', f: 'grayscale(1) contrast(1.2)' },
    { name: 'CINEMA-PRO-MASTER', f: 'contrast(1.3) saturate(1.2) sepia(0.2)' },
    { name: 'MOVIEMATIC-OG', f: 'hue-rotate(-10deg) contrast(1.1) saturate(1.1)' },
    { name: 'KODAK-GOLD-OG', f: 'saturate(1.4) contrast(1.1) hue-rotate(-5deg)' },
    { name: 'PORTRA-OG', f: 'saturate(1.1) brightness(1.1) contrast(0.9) hue-rotate(-5deg)' },
    { name: 'FUJI-OG', f: 'saturate(1.2) hue-rotate(10deg) brightness(1.05)' },
    { name: 'VINTAGE-IVORY', f: 'sepia(0.4) contrast(0.9) brightness(1.1)' },
    { name: 'VINTAGE-1970', f: 'sepia(0.5) hue-rotate(-10deg) saturate(1.2)' },
    { name: 'VINTAGE-1990', f: 'contrast(1.1) saturate(0.8) brightness(0.9)' },

    // --- ğŸ¨ PIXIR PRO SERIES (Artistic & Sharp) ---
    { name: 'PIXIR-VIBRANCE-MAX', f: 'saturate(2.2) contrast(1.3) brightness(1.1)' },
    { name: 'PIXIR-URBAN-COOL', f: 'hue-rotate(185deg) saturate(1.1) contrast(1.2) brightness(1.05)' },
    { name: 'PIXIR-DEEP-BOLD', f: 'contrast(1.7) saturate(1.4) brightness(0.95)' },

    // --- ğŸ–¼ï¸ BACKGROUND SHIFT SIMULATIONS ---
    { name: 'BG-STUDIO-WHITE', f: 'brightness(1.4) contrast(0.8) saturate(1.1)' },
    { name: 'BG-MIDNIGHT-VOID', f: 'brightness(0.6) contrast(1.5) saturate(0.8) hue-rotate(200deg)' },
    { name: 'BG-GOLDEN-FIELD', f: 'sepia(0.4) saturate(1.8) contrast(1.1) brightness(1.05)' },
    { name: 'BG-NEON-DISTRICT', f: 'hue-rotate(280deg) saturate(2.5) contrast(1.3) brightness(0.8)' },

    // --- ğŸ¤– SHARP AI REMASTERING & "REMINI" RECOVERY ---
    { name: 'AI-8K-SUPER-RESOLUTION', f: 'contrast(1.5) saturate(1.1) brightness(1.05) contrast(1.2)' },
    { name: 'AI-REMINI-PRO-v3', f: 'contrast(1.35) saturate(1.2) brightness(1.1) contrast(1.1)' },
    { name: 'AI-DEEP-TEXTURE-FIX', f: 'contrast(1.8) brightness(1.0) saturate(1.1) contrast(1.2)' },
    { name: 'AI-LOW-LIGHT-RESCUE', f: 'brightness(1.4) contrast(1.2) saturate(1.1) sepia(0.05) contrast(1.05)' },

    // --- ğŸ’ UNIQUE & RARE SIMULATIONS ---
    { name: 'AI-LIQUID-SILVER', f: 'grayscale(1) contrast(2.2) brightness(1.1) invert(0.05)' },
    { name: 'AI-INFRARED-LUMINA', f: 'invert(0.1) hue-rotate(120deg) saturate(2.1) contrast(1.2)' },
    { name: 'AI-GLASS-DISTORTION', f: 'contrast(1.6) brightness(1.1) saturate(0.8) hue-rotate(5deg)' },
    { name: 'AI-TECH-NOIR', f: 'grayscale(0.5) hue-rotate(180deg) contrast(1.5) brightness(0.85)' },
    { name: 'AI-CRISP-CARTOON', f: 'saturate(2.5) contrast(1.6) brightness(1.1) sepia(0.05)' },

    // --- ğŸ› ï¸ PHOTOSHOP PRO TOOLS ---
    { name: 'PS-HIGH-PASS-SHARP', f: 'contrast(1.8) brightness(1.05) saturate(1.1)' },
    { name: 'PS-AUTO-TONE-v2', f: 'contrast(1.2) saturate(1.2) brightness(1.1)' },
    { name: 'PS-DEEP-MATTE', f: 'contrast(0.7) brightness(1.2) saturate(1.1) sepia(0.05)' },
    { name: 'PS-VIBRANCE-BOOST', f: 'saturate(1.8) brightness(1.05) contrast(1.1)' },
    { name: 'PS-COLOR-BALANCE', f: 'hue-rotate(-10deg) saturate(1.3) contrast(1.1) brightness(1.05)' },

    // --- ğŸ’ RARE OPTICAL & AVANT-GARDE (New Unique Additions) ---
    { name: 'MYSTIC-FOREST', f: 'hue-rotate(80deg) contrast(1.2) saturate(1.4) brightness(0.9)' },
    { name: 'PRISM-REFRACTION', f: 'hue-rotate(220deg) saturate(1.8) contrast(1.1) brightness(1.1)' },
    { name: 'MIDNIGHT-TOKYO', f: 'hue-rotate(190deg) contrast(1.4) brightness(0.9) saturate(1.3)' },
    { name: 'ALIEN-INFRARED', f: 'invert(0.1) hue-rotate(90deg) contrast(1.3) saturate(1.5)' },
    { name: 'VELVET-PURPLE-HAZE', f: 'sepia(0.2) hue-rotate(240deg) contrast(1.3) saturate(1.2) brightness(0.95)' },
    { name: 'SUNSET-BOULEVARD', f: 'sepia(0.4) saturate(1.8) contrast(1.1) brightness(1.1) hue-rotate(-10deg)' },
    { name: 'CYBER-GLITCH-SIM', f: 'saturate(3.0) contrast(1.5) brightness(0.9) hue-rotate(10deg)' },
    { name: 'ETHEREAL-ANGEL', f: 'brightness(1.25) contrast(0.9) saturate(1.1) hue-rotate(-5deg)' },

    // --- ğŸ“¸ INSTAGRAM & VSCO CLASSICS ---
    { name: 'CLARENDON', f: 'contrast(1.2) brightness(1.1) saturate(1.1) hue-rotate(5deg)' },
    { name: 'GINGHAM', f: 'brightness(1.05) sepia(0.2) contrast(0.9) saturate(0.9)' },
    { name: 'VSCO-A6 (Clean)', f: 'saturate(1.1) brightness(1.05) contrast(1.05) sepia(0.05)' },
    { name: 'VSCO-M5 (Moody)', f: 'contrast(0.9) saturate(0.8) sepia(0.25) brightness(0.95)' },
    { name: 'VSCO-C1 (Vibrant)', f: 'saturate(1.4) contrast(1.1) brightness(1.05) hue-rotate(-2deg)' },

    // --- ğŸï¸ RARE & COLLECTOR FILM STOCKS ---
    { name: 'KODAK-PORTRA-400', f: 'saturate(1.15) brightness(1.1) contrast(0.95) sepia(0.12)' },
    { name: 'FUJI-VELVIA-50', f: 'saturate(1.6) contrast(1.2) brightness(1.05)' },
    { name: 'CINESTILL-800T', f: 'contrast(1.2) saturate(1.1) brightness(1.1) hue-rotate(-5deg) sepia(0.1)' },
    { name: 'POLAROID-600', f: 'contrast(1.1) brightness(1.1) sepia(0.25) saturate(0.8)' },

    // --- ğŸ PRO MONOCHROME & BW FILM ---
    { name: 'BW-SILVER-HALIDE', f: 'grayscale(1) brightness(1.2) contrast(1.5) sepia(0.1)' },
    { name: 'BW-NOIR-PRO-V2', f: 'grayscale(1) contrast(2.5) brightness(0.6)' },
    { name: 'BW-STREET-STYLE', f: 'grayscale(1) contrast(1.4) brightness(1.0)' },

];
cfg.adj = { b: 100, c: 100, s: 100 };

function toggleFilterUI() {
    const el = document.getElementById('filter-wrapper');
    const btn = document.querySelector("button[onclick='toggleFilterUI()']");
    if(el.style.display === 'flex') {
        el.style.display = 'none';
        btn.innerHTML = "MAGIC FILTERS âœ¨";
        btn.style.color = "#00ffff"; btn.style.borderColor = "#00ffff";
    } else {
        el.style.display = 'flex';
        el.classList.add('active');
        btn.innerHTML = "CLOSE FILTERS âœ–";
        btn.style.color = "#ff00ff"; btn.style.borderColor = "#ff00ff";
        
        if(document.getElementById('filter-list').children.length === 0) renderFilters();
        if(!document.getElementById('adj-panel')) createAdjustUI();
        if(!document.getElementById('open-adj-btn')) createSmartEditBtn();
        
        document.getElementById('filter-list').style.display = 'flex';
        document.getElementById('adj-panel').style.display = 'none';
        
        // ğŸ”¥ FORCE ADJUST BUTTON VISIBLE (The Fix)
        // This ensures the button is always there, even for the original image
        const adjBtn = document.getElementById('open-adj-btn');
        if(adjBtn) {
            adjBtn.style.display = 'block';
            adjBtn.style.visibility = 'visible';
            adjBtn.style.opacity = '1';
        }
    }
    playClick();
}

function createSmartEditBtn() {
    const wrapper = document.getElementById('filter-wrapper');
    const b = document.createElement('button');
    b.id = 'open-adj-btn';
    b.innerHTML = "ADJUST SETTINGS âš™ï¸";
    b.style.cssText = "width:100%; background:black; color:#00ffff; border:2px solid #00ffff; font-weight:900; padding:12px; margin-top:10px; border-radius:8px; cursor:pointer; display:none; font-family:'Segoe UI', sans-serif; letter-spacing:1px;";
    b.onclick = openAdjust;
    wrapper.insertBefore(b, document.getElementById('filter-list').nextSibling);
}

function createAdjustUI() {
    const wrapper = document.getElementById('filter-wrapper');
    const p = document.createElement('div');
    p.id = 'adj-panel';
    p.style.cssText = "display:none; flex-direction:column; width:100%; gap:15px; padding:10px 5px;";
    const baseStyle = "width:100%; -webkit-appearance:none; height:6px; background:#444; border-radius:3px; outline:none;";
    const sliderHTML = (id, func, label, color) => `
        <div style="display:flex; justify-content:space-between; color:${color}; font-family:'Segoe UI', sans-serif; font-size:12px; font-weight:bold; letter-spacing:1px; margin-bottom:5px;">
            <span>${label}</span><span id="val-${id}" style="color:#fff;">100%</span>
        </div>
        <input type="range" id="sl-${id}" min="0" max="200" value="100" class="neon-slider" data-col="${color}" style="${baseStyle}" oninput="${func}">
    `;
    p.innerHTML = sliderHTML('b', "adjChange('b', this.value, this)", "BRIGHTNESS", "#ff0055") +
                  sliderHTML('c', "adjChange('c', this.value, this)", "CONTRAST", "#00ffff") +
                  sliderHTML('s', "adjChange('s', this.value, this)", "SATURATION", "#ff0055");
    const doneBtn = document.createElement('button');
    doneBtn.innerText = "DONE âœ“";
    doneBtn.style.cssText = "width:100%; background:#00ff00; color:#000; font-weight:900; border:none; padding:12px; margin-top:10px; border-radius:4px; cursor:pointer;";
    doneBtn.onclick = closeAdjust;
    p.appendChild(doneBtn);
    wrapper.appendChild(p);
    setTimeout(() => { ['b','c','s'].forEach(k => { const el = document.getElementById('sl-'+k); if(el) updateSliderColor(el, 100, 200); }); }, 50);
}

function updateSliderColor(el, val, max) {
    const percent = (val / max) * 100;
    const col = el.getAttribute('data-col') || '#00ffff';
    el.style.background = `linear-gradient(to right, ${col} 0%, ${col} ${percent}%, #444 ${percent}%, #444 100%)`;
}

function renderFilters() {
    const list = document.getElementById('filter-list');
    list.innerHTML = '';
    const previewSrc = i.src || 'data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7'; 
    magicFilters.forEach(mf => {
        const btn = document.createElement('button');
        btn.className = 'filter-btn';
        const img = document.createElement('img');
        img.className = 'filter-preview';
        img.src = previewSrc;
        img.style.filter = mf.f; 
        const span = document.createElement('span');
        span.className = 'filter-name';
        span.innerText = mf.name;
        btn.appendChild(img);
        btn.appendChild(span);
        btn.onclick = () => { applyFilter(mf.f, btn); };
        list.appendChild(btn);
    });
}

function openAdjust() {
    document.getElementById('filter-list').style.display = 'none';
    document.getElementById('open-adj-btn').style.display = 'none';
    document.getElementById('adj-panel').style.display = 'flex';
    playClick();
}

function closeAdjust() {
    document.getElementById('adj-panel').style.display = 'none';
    document.getElementById('filter-list').style.display = 'flex';
    document.getElementById('open-adj-btn').style.display = 'block';
    playClick();
}

function adjChange(type, val, el) {
    cfg.adj[type] = parseInt(val);
    document.getElementById(`val-${type}`).innerText = val + "%";
    if(el) updateSliderColor(el, val, 200);
    // REMOVED c.style.filter here to prevent global filter application
    d(); 
}
function applyFilter(filterVal, btn) {
    // 1. Check if we are actually changing the filter
    if (cfg.filter !== filterVal) {
        
        // 2. Reset adjustment sliders to standard (100%)
        cfg.adj = { b: 100, c: 100, s: 100 };
        
        // Reset the slider UI elements
        ['b', 'c', 's'].forEach(k => {
            const el = document.getElementById('sl-' + k);
            if (el) { 
                el.value = 100; 
                const valDisplay = document.getElementById('val-' + k);
                if (valDisplay) valDisplay.innerText = "100%"; 
                
                // Keep the slider gradient logic if you use it
                if(typeof updateSliderColor === 'function') {
                    updateSliderColor(el, 100, 200);
                }
            }
        });
        
        // 3. Update the Data Configuration
        cfg.filter = filterVal;
        
        // ğŸ›¡ï¸ THE OLD ANDROID PROTECTION:
        // We do absolutely NOTHING to c.style.filter here.
        // We do not touch the canvas CSS. 
        // We only save the data to 'cfg' and let 'd()' handle the rest.
        
        // 4. Update UI Button Highlights
        document.querySelectorAll('.filter-btn').forEach(b => {
            b.classList.remove('active-filter');
        });
        if (btn) {
            btn.classList.add('active-filter');
        }
        
        // 5. Trigger the Drawing Engine (The one we did surgery on)
        d(); 
        
        // 6. Sound Effect
        if (typeof playClick === 'function') {
            playClick();
        }
    }
}

// --- ğŸ”’ 2. BOUNDARY LOCK LOGIC ---
let isBoundaryLocked = true;
function toggleBoundaryLock() {
    isBoundaryLocked = !isBoundaryLocked;
    const btn = document.getElementById('lock-btn');
    if (isBoundaryLocked) {
        if(btn) {
            btn.innerHTML = "BOUNDARY LOCK: ON ğŸ”’";
            btn.style.borderColor = "#00ff00";
            btn.style.color = "#00ff00";
        }
    } else {
        if(btn) {
            btn.innerHTML = "BOUNDARY LOCK: OFF ğŸ”“";
            btn.style.borderColor = "#ff0000";
            btn.style.color = "#ff0000";
        }
    }
    d();
    if(typeof playClick === 'function') playClick();
}
// --- ğŸ› ï¸ CORE DRAWING ENGINE (JAN 16th FIX: IPHONE HARD BAKE + ANDROID SHIELD) ---
function d(){ 
  if(!x) return;
  x.clearRect(0,0,800,800); 

  // 1. CALCULATE FILTER STRING
  let cssFilter = '';
  if(cfg.filter && cfg.filter !== 'none') cssFilter += cfg.filter;
  if(cfg.adj.b !== 100) cssFilter += ` brightness(${cfg.adj.b}%)`;
  if(cfg.adj.c !== 100) cssFilter += ` contrast(${cfg.adj.c}%)`;
  if(cfg.adj.s !== 100) cssFilter += ` saturate(${cfg.adj.s}%)`;

  // ğŸ§  SMART DEVICE DETECTION
  const isIOS = /iPad|iPhone|iPod/.test(navigator.userAgent) && !window.MSStream;

  // 2. SCREEN PREVIEW (VISUALS)
  if (isIOS) {
      // ğŸ IPHONE: Apply CSS so the user sees changes instantly on screen
      if(c) {
          c.style.filter = (cssFilter !== '') ? cssFilter : 'none';
          c.style.webkitFilter = (cssFilter !== '') ? cssFilter : 'none';
      }
  } else {
      // ğŸ¤– ANDROID SHIELD: Force CSS to 'none'.
      // This protects Android from the "Double Filter" and "Tinted Frame" glitches.
      if(c) {
          c.style.filter = 'none';
          c.style.webkitFilter = 'none';
      }
  }

  // 3. SIZE & BOUNDARY LOGIC
  let drawM = cfg.m;
  if (cfg.pColor && cfg.m > 360) { drawM = 360; }

  if(i.src && isBoundaryLocked){
      const rad = cfg.r * Math.PI / 180;
      const cos = Math.abs(Math.cos(rad)), sin = Math.abs(Math.sin(rad));
      const mathM = drawM + 15; 
      const reqW = (mathM*2*cos + mathM*2*sin), reqH = (mathM*2*sin + mathM*2*cos);
      const minS = Math.max(reqW/i.width, reqH/i.height);
      if(cfg.s < minS) { cfg.s = minS; if(window.zSl) zSl.value = minS; if(window.zVal) zVal.innerText = Math.round((minS/zSl.min)*100)+"%"; }
      const w = i.width * cfg.s, h = i.height * cfg.s;
      const rangeX = Math.max(0, (w - reqW)/2), rangeY = Math.max(0, (h - reqH)/2);
      cfg.x = Math.max(400 - rangeX, Math.min(400 + rangeX, cfg.x));
      cfg.y = Math.max(400 - rangeY, Math.min(400 + rangeY, cfg.y));
  }

  // 4. IMAGE DRAWING (THE SAVE FIX)
  if(i.src){
      x.save(); 
      x.beginPath(); x.arc(400, 400, drawM + 2, 0, Math.PI * 2); x.clip(); 
      
      let w = i.width * cfg.s, h = i.height * cfg.s;
      x.translate(cfg.x, cfg.y); 
      x.rotate(cfg.r * Math.PI / 180);
      
      // ğŸ”¥ THE IPHONE FIX (Hard Bake)
      // This is the Jan 16th Logic:
      if (isIOS) {
          // Force filter into pixels for iPhone download
          x.filter = (cssFilter !== '') ? cssFilter : 'none';
      } else {
          // ğŸ›¡ï¸ ANDROID PROTECTION
          // Force none to prevent double-filtering/tinting
          x.filter = 'none'; 
      }
      
      x.drawImage(i, -w/2, -h/2, w, h);
      x.restore(); 
  }
  
  // 5. RESET FILTER (Android only â€“ keep iOS filter alive until rasterization)
  if (!isIOS) {
      x.filter = 'none';
  }

  // 6. FRAME DRAWING
  if (cfg.pColor) {
      x.save(); x.beginPath(); x.arc(400, 400, drawM, 0, Math.PI * 2); 
      x.lineWidth = 6; x.strokeStyle = cfg.pColor; x.stroke(); x.restore();
      
      x.save(); 
      if ((cfg.pColor === '#000000' || cfg.pColor === '#808080') && cfg.pType === 'neon') {
          const sC = cfg.pColor; 
          x.beginPath(); x.arc(400, 400, drawM, 0, Math.PI * 2); x.lineWidth = 25; x.strokeStyle = sC; x.shadowBlur = 60; x.shadowColor = sC; x.stroke();
          x.beginPath(); x.arc(400, 400, drawM, 0, Math.PI * 2); x.lineWidth = 18; x.strokeStyle = sC; x.shadowBlur = 10; x.shadowColor = sC; x.stroke();
          x.beginPath(); x.arc(400, 400, drawM, 0, Math.PI * 2); x.lineWidth = 6; x.strokeStyle = '#FFFFFF'; x.stroke();
      } else if (cfg.pColor === '#FEFEFE' && cfg.pType === 'neon') {
          x.beginPath(); x.arc(400, 400, drawM, 0, Math.PI * 2); x.lineWidth = 15; x.strokeStyle = '#FFFFFF'; x.shadowBlur = 60; x.shadowColor = '#FFFFFF'; x.stroke();
          x.beginPath(); x.arc(400, 400, drawM, 0, Math.PI * 2); x.lineWidth = 6; x.strokeStyle = '#FFFFFF'; x.stroke();
      } else if (cfg.pType === 'neon') {
          x.beginPath(); x.arc(400, 400, drawM, 0, Math.PI * 2); x.lineWidth = 25; x.strokeStyle = cfg.pColor; x.shadowBlur = 30; x.shadowColor = cfg.pColor; x.stroke();
          x.beginPath(); x.arc(400, 400, drawM, 0, Math.PI * 2); x.lineWidth = 8; x.strokeStyle = '#FFFFFF'; x.stroke();
      } else {
          x.beginPath(); x.arc(400, 400, drawM, 0, Math.PI * 2); x.lineWidth = 25; 
          if (cfg.pType === 'gold') {
              let g = x.createLinearGradient(0, 0, 800, 800); g.addColorStop(0, '#FFD700'); g.addColorStop(0.5, '#FDB931'); g.addColorStop(1, '#FFD700'); x.strokeStyle = g;
          } else if (cfg.pType === 'silver') { 
              let g = x.createLinearGradient(0, 0, 800, 800); g.addColorStop(0, '#E0E0E0'); g.addColorStop(0.5, '#B0B0B0'); g.addColorStop(1, '#E0E0E0'); x.strokeStyle = g;
          } else { x.strokeStyle = cfg.pColor; }
          x.stroke(); 
      }
      x.restore();
  }
  if(f.src) x.drawImage(f,0,0,800,800); 
}

// --- ğŸ“‚ FILE HANDLERS (SMART AUTO-SIZING: 400px vs 375px) ---
function handleFile(e){
    const files = e.target ? e.target.files : e.files; if(!files || !files[0]) return;
    const r = new FileReader();
    r.onload = v => {
        const n = new Image();
        n.onload = async () => {
            if ('decode' in n) { try { await n.decode(); } catch(err) { } }
            i = n; cfg.x = 400; cfg.y = 400; cfg.r = 0;
            
            // ğŸ”¥ LOGIC: If NO frame is active, go to 400px (Full Size).
            // If a frame IS active, this line is skipped, so it stays at 375px.
            if(!f.src && !cfg.pColor) { cfg.m = 400; mSl.value = 400; mVal.innerText = "400px"; }
            
            const fillSize = Math.max(800/i.width, 800/i.height);
            if(isBoundaryLocked) {
                const rad = cfg.r * Math.PI / 180;
                const cos = Math.abs(Math.cos(rad)), sin = Math.abs(Math.sin(rad));
                const reqW = (cfg.m*2*cos + cfg.m*2*sin), reqH = (cfg.m*2*sin + cfg.m*2*cos);
                const minS = Math.max(reqW/i.width, reqH/i.height);
                zSl.min = minS; 
                cfg.s = Math.max(minS, fillSize); 
                zSl.value = cfg.s; 
                zVal.innerText = Math.round((cfg.s/zSl.min)*100)+"%";
            } else { 
                cfg.s = fillSize; zSl.min = 0.01; zSl.value = cfg.s; zVal.innerText = "100%"; 
            }
            updS(zSl); updS(mSl);
            if(typeof renderFilters === 'function') renderFilters(); 
            d(); 
            const uiPanel = document.querySelector('.ui'); uiPanel.style.paddingBottom = "200px"; 
            document.getElementById('save').disabled = false;
        }; n.src = v.target.result;
    }; r.readAsDataURL(files[0]);
}
function handleFrame(e){
    const files = e.target ? e.target.files : e.files; if(!files || !files[0]) return;
    const r = new FileReader();
    r.onload = v => {
        const n = new Image();
        n.onload = () => { 
            f.src = n.src; 
            cfg.m = 375; mSl.value = 375; mVal.innerText = "375px";
            cfg.pColor = null; cfg.pType = null; mLbl.innerText = "FRAME OPENING SIZE"; 
            updS(mSl); d(); 
        };
        n.src = v.target.result;
    }; r.readAsDataURL(files[0]);
}

function updateZ(v){ cfg.s=parseFloat(v); zVal.innerText=Math.round((v/zSl.min)*100)+"%"; d(); }
function updateR(v){ cfg.r=parseInt(v); rVal.innerText=v+"Â°"; d(); }
function updateM(v){ cfg.m=parseInt(v); mVal.innerText=v+"px"; d(); }
function centerSubject(){ cfg.x=400; cfg.y=400; cfg.r=0; rSl.value=0; d(); playShutter(); }

function resetProject(){ 
    i=new Image(); f=new Image(); 
    
    // ğŸ”¥ RESET TO 400px (Normal Mode)
    cfg={s:1, m:400, x:400, y:400, r:0, pColor:null, pType:null, filter:'none', adj:{b:100,c:100,s:100}};
    zSl.value=1; rSl.value=0; mSl.value=400; mVal.innerText="400px"; mLbl.innerText = "CIRCLE SIZE";
    
    document.getElementById('u1').value = ''; document.getElementById('u2').value = '';
    c.style.filter = 'none'; document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active-filter'));
    if(document.getElementById('filter-list')) document.getElementById('filter-list').innerHTML = '';
    
    // Close Adjustment Panel
    if(document.getElementById('adj-panel')) { 
        document.getElementById('filter-list').style.display = 'flex'; 
        document.getElementById('adj-panel').style.display = 'none'; 
        closeAdjust(); 
    }
    if(document.getElementById('open-adj-btn')) document.getElementById('open-adj-btn').style.display = 'none';
    
    d(); playShutter(); updS(zSl); updS(rSl); updS(mSl); 
    document.getElementById('save').disabled = true; document.querySelector('.ui').style.paddingBottom = "0px"; 
}

function downloadPic() {
    if (!i.src) return;

    // 1. Internal Backup
    if (typeof saveToGallery === 'function') {
        saveToGallery();
    }

    // 2. ENABLE SAVE MODE (Triggers iPhone Hard Bake)
    // Android ignores this flag completely.
    window.isSaving = true;
    d(); 

    // 3. Generate Unique Name
    const uniqueName = `Arcade_${Date.now()}_${Math.floor(Math.random() * 99999)}.png`;

    // 4. Create Blob & Download
    c.toBlob(function(blob) {
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = uniqueName; 
        document.body.appendChild(a);
        a.click();
        
        // 5. CLEANUP & RESTORE
        // We wait 100ms, then turn off Save Mode so the screen goes back to normal.
        setTimeout(() => {
            document.body.removeChild(a);
            window.URL.revokeObjectURL(url);
            
            window.isSaving = false;
            d(); 
        }, 100);
    }, 'image/png');
    
    // 6. Sound Effect
    playShutter();
}


function updS(el){ if(el.parentElement.classList.contains('ui-gif')) return; const val = (el.value-el.min)/(el.max-el.min)*100; el.style.setProperty('--v', val + '%'); }
document.querySelectorAll('input[type=range]').forEach(el => { el.addEventListener('input', () => updS(el)); updS(el); });
// --- âš™ï¸ ADJUSTMENT UI LOGIC (AGGRESSIVE FOCUS MODE) ---
function openAdjust() {
    document.getElementById('filter-list').style.display = 'none';
    document.getElementById('open-adj-btn').style.display = 'none';
    document.getElementById('adj-panel').style.display = 'flex';
    
    // ğŸ”¥ AGGRESSIVE HIDE: Hunt down buttons everywhere
    const uiElements = document.querySelectorAll('.ui button, .ui label, #lock-btn');
    uiElements.forEach(el => {
        if(el.closest('#filter-wrapper')) return; // Don't hide the sliders!
        if(el.closest('#adj-panel')) return;     // Don't hide the "Done" button!
        if(el.innerText && el.innerText.includes('HIDE MENU')) return; // Keep top toggle
        
        el.style.display = 'none';
    });
    playClick();
}

function closeAdjust() {
    document.getElementById('adj-panel').style.display = 'none';
    document.getElementById('filter-list').style.display = 'flex';
    document.getElementById('open-adj-btn').style.display = 'block';
    
    // ğŸ”¥ AGGRESSIVE RESTORE: Bring them back
    const uiElements = document.querySelectorAll('.ui button, .ui label, #lock-btn');
    uiElements.forEach(el => {
        if(el.closest('#filter-wrapper')) return;
        if(el.innerText && el.innerText.includes('HIDE MENU')) return;
        el.style.display = ''; // Restore to default CSS
    });
    playClick();
}

// --- ğŸ–±ï¸ INTERACTION ENGINE (REPAIRED FOR IPHONE & REALME) ---
let isP=false, tStart={x:0,y:0}, initialDist=0, initialScale=1, initialAngle=0, initialRot=0;

c.addEventListener('touchstart', e => { 
    if(!i.src) return; e.preventDefault(); 
    const t = e.touches[0];
    if(e.touches.length===1){ isP=true; tStart={x:t.pageX, y:t.pageY}; } 
    else if(e.touches.length===2){ 
        isP=false; const dx = e.touches[0].pageX - e.touches[1].pageX; const dy = e.touches[0].pageY - e.touches[1].pageY; 
        initialDist = Math.sqrt(dx*dx + dy*dy); initialScale = cfg.s; initialAngle = Math.atan2(dy, dx); initialRot = cfg.r; 
    } 
}, { passive: false });

c.addEventListener('touchmove', e => { 
    if(!i.src) return; e.preventDefault(); 
    if(e.touches.length===1 && isP){ 
        const t = e.touches[0]; let scale = 800 / c.offsetWidth; 
        cfg.x += (t.pageX - tStart.x) * scale; cfg.y += (t.pageY - tStart.y) * scale; 
        tStart={x:t.pageX, y:t.pageY}; d(); 
    } else if(e.touches.length===2){ 
        const dx = e.touches[0].pageX - e.touches[1].pageX; const dy = e.touches[0].pageY - e.touches[1].pageY; 
        const dist = Math.sqrt(dx*dx + dy*dy); const scaleFactor = dist / initialDist; 
        let newScale = initialScale * scaleFactor; cfg.s = Math.max(zSl.min, Math.min(zSl.max, newScale)); 
        zSl.value = cfg.s; zVal.innerText=Math.round((cfg.s/zSl.min)*100)+"%"; 
        const angle = Math.atan2(dy, dx); let rotationDiff = (angle - initialAngle) * (180/Math.PI); 
        cfg.r = (initialRot + rotationDiff) % 360; rSl.value = (cfg.r % 360 + 360) % 360; 
        rVal.innerText = Math.round(cfg.r) + "Â°"; updS(zSl); updS(rSl); d(); 
    } 
}, { passive: false });

// --- âš¡ NEON GIF ENGINE (OPTIMIZED: 12 WORKERS FOR STABILITY) ---
const workerBlob = new Blob(['importScripts(\'https://cdnjs.cloudflare.com/ajax/libs/gif.js/0.2.0/gif.worker.js\');'], { type: 'application/javascript' });
const workerUrl = URL.createObjectURL(workerBlob);

const gfInput = document.getElementById('gfInput'); const upBtn = document.getElementById('upBtn'); const v = document.getElementById('v'); const o = document.getElementById('o'); const vp = document.getElementById('vp'); const speed = document.getElementById('speed'); const sv = document.getElementById('sv'); const zoom = document.getElementById('zoom'); const zv = document.getElementById('zv'); const go = document.getElementById('go'); const msg = document.getElementById('msg'); const dlBox = document.getElementById('dlBox'); const dl = document.getElementById('dl'); const resetBox = document.getElementById('resetBox');
let gifX = 0, gifY = 0, vidW = 0, vidH = 0, renderW, renderH, isProcessingGif = false;

function resetGifProject() { 
    v.pause(); v.src = ""; v.load(); v.style.display = 'none'; o.src = ''; o.style.display = 'none'; dlBox.style.display = 'none'; 
    dl.href = "#"; dl.removeAttribute('download'); dl.style.pointerEvents = 'none'; dl.style.opacity = '0.5'; dl.onclick = (e) => { e.preventDefault(); return false; }; 
    resetBox.style.display = 'none'; document.getElementById('goBox').style.display = 'inline-block'; go.disabled = false; upBtn.disabled = false; zoom.disabled = false; zoom.value = 100; speed.disabled = false; msg.classList.remove('active'); zv.innerText = "100%"; gfInput.value = ''; gifX = 0; gifY = 0; isProcessingGif = false; vp.style.pointerEvents = 'auto'; 
}
gfInput.onchange = (e) => { const file = e.target.files[0]; if (!file) return; v.style.display = 'block'; o.style.display = 'none'; dlBox.style.display = 'none'; v.src = URL.createObjectURL(file); v.playbackRate = parseFloat(speed.value); go.disabled = false; v.onloadedmetadata = () => { vidW = v.videoWidth; vidH = v.videoHeight; setCoverSize(); v.play(); }; };
function setCoverSize() { const boxSize = 320; const aspect = vidW / vidH; if (aspect > 1) { renderH = boxSize; renderW = boxSize * aspect; } else { renderW = boxSize; renderH = boxSize / aspect; } v.style.width = renderW + 'px'; v.style.height = renderH + 'px'; zoom.min = 100; updateGifTransform(); gifX = 0; gifY = 0; }
function updateGifTransform() { if (!v.src) return; const z = parseInt(zoom.value) / 100; const currentW = renderW * z; const currentH = renderH * z; const boxSize = 320; const maxX = Math.max(0, (currentW - boxSize) / 2); const maxY = Math.max(0, (currentH - boxSize) / 2); gifX = Math.max(-maxX, Math.min(maxX, gifX)); gifY = Math.max(-maxY, Math.min(maxY, gifY)); v.style.transform = `translate(calc(-50% + ${gifX}px), calc(-50% + ${gifY}px)) scale(${z})`; }
zoom.oninput = function () { zv.innerText = this.value + '%'; updateGifTransform(); };
speed.oninput = () => { sv.innerText = speed.value + 'x'; if (v.src) v.playbackRate = parseFloat(speed.value); };

let isGifDrag = false;
let startX = 0, startY = 0, initX = 0, initY = 0; 
vp.addEventListener('touchstart', e => { if (isProcessingGif) return; if (!v.src || v.style.display === 'none') return; isGifDrag = true; startX = e.touches[0].clientX; startY = e.touches[0].clientY; initX = gifX; initY = gifY; }, { passive: false });
vp.addEventListener('touchmove', e => { if (isProcessingGif) return; if (!v.src || v.style.display === 'none') return; if (!isGifDrag) return; e.preventDefault(); const dx = e.touches[0].clientX - startX; const dy = e.touches[0].clientY - startY; gifX = initX + dx; gifY = initY + dy; requestAnimationFrame(updateGifTransform); }, { passive: false });

go.onclick = () => {
    if (!v.src) return; go.disabled = true; upBtn.disabled = true; zoom.disabled = true; speed.disabled = true; msg.innerText = "Processing..."; msg.classList.add('active'); isProcessingGif = true; vp.style.pointerEvents = 'none'; 
    const OUT_SIZE = 480; const gif = new GIF({ workers: 12, quality: 20, width: OUT_SIZE, height: OUT_SIZE, workerScript: workerUrl, dither: false });
    const canvas = document.createElement('canvas'); canvas.width = OUT_SIZE; canvas.height = OUT_SIZE; const ctx = canvas.getContext('2d');
    const fps = 15, duration = v.duration, playbackSpeed = parseFloat(speed.value), capVid = document.createElement('video'); capVid.src = v.src; capVid.muted = true; capVid.playsInline = true;
    capVid.onloadeddata = () => {
        let cTime = 0; const currentVpSize = 320; const outputScale = OUT_SIZE / currentVpSize; const scale = parseInt(zoom.value) / 100; const aspect = capVid.videoWidth / capVid.videoHeight;
        let drawW, drawH; if (aspect > 1) { drawH = currentVpSize; drawW = currentVpSize * aspect; } else { drawW = currentVpSize; drawH = currentVpSize / aspect; }
        drawW *= scale * outputScale; drawH *= scale * outputScale; const finalX = gifX * outputScale; const finalY = gifY * outputScale;
        let dx = (OUT_SIZE - drawW) / 2 + finalX; let dy = (OUT_SIZE - drawH) / 2 + finalY;
        const captureFrame = () => { if (cTime >= duration) { msg.innerText = "Encoding..."; gif.render(); return; } capVid.currentTime = cTime; };
        capVid.onseeked = () => { ctx.fillStyle = '#000000'; ctx.fillRect(0, 0, OUT_SIZE, OUT_SIZE); ctx.drawImage(capVid, dx, dy, drawW, drawH); gif.addFrame(ctx, { copy: true, delay: (1000 / fps) / playbackSpeed }); cTime += (1 / fps); setTimeout(captureFrame, 10); };
        captureFrame();
    };
    gif.on('finished', blob => { 
        const reader = new FileReader();
        reader.onloadend = () => {
            const finalData = reader.result; v.style.display = 'none'; o.src = finalData; o.style.display = 'block'; 
            dl.href = finalData; dl.download = `Arcade_GIF_${Date.now()}.gif`; 
            dl.style.pointerEvents = 'auto'; dl.style.opacity = '1'; dl.onclick = null; 
            dlBox.style.display = 'block'; resetBox.style.display = 'block'; 
            msg.classList.remove('active'); document.getElementById('goBox').style.display = 'none'; isProcessingGif = false; vp.style.pointerEvents = 'auto'; 
        }; reader.readAsDataURL(blob);
    });
};

// --- ğŸŒ GLOBAL MENU HANDLER ---
window.onclick = e => { 
    initAudio(); 
    if (panel.classList.contains('open') && !panel.contains(e.target) && !e.target.classList.contains('menu-toggle')) { panel.classList.remove('open'); playClick(); }
    if (typeof swMenu !== 'undefined' && swMenu.style.display === 'flex' && !document.querySelector('.switch-container').contains(e.target)) { swMenu.style.display = 'none'; playClick(); }
    if (typeof thMenu !== 'undefined' && thMenu.style.display === 'flex' && !document.querySelector('.switch-container').contains(e.target)) { thMenu.style.display = 'none'; playClick(); }
    const fw = document.getElementById('filter-wrapper');
    if (fw && fw.style.display === 'flex' && !fw.contains(e.target) && !e.target.innerText.includes('FILTERS') && !e.target.id.includes('val')) {
        fw.style.display = 'none';
        const btn = document.querySelector("button[onclick='toggleFilterUI()']");
        if(btn) { btn.innerHTML = "MAGIC FILTERS âœ¨"; btn.style.color = "#00ffff"; btn.style.borderColor = "#00ffff"; }
    }
};
// --- ğŸ’ DESIGNER EDITION GALLERY (MASTER FIX: UNLIMITED SAVES & INSTANT DELETE) ---

// 1. Data Structure
let myGallery = JSON.parse(localStorage.getItem('arcadeGallery')) || [];

// 2. Save Logic (Images) - ALLOWS DUPLICATES
function saveToGallery() {
    if(!c) return; 
    const data = c.toDataURL();
    // ğŸ”¥ RANDOM ID: Ensures every save is unique
    const id = Date.now() + Math.floor(Math.random() * 100000); 
    const item = { id: id, type: 'img', data: data, fav: false, date: new Date().toLocaleDateString() };
    myGallery.unshift(item); 
    localStorage.setItem('arcadeGallery', JSON.stringify(myGallery));
    refreshGalleryIfOpen();
    showToast("ğŸ’¾ BACKUP SAVED", "#00ff00");
}

// 3. Save Logic (Text)
function saveTextToGallery(text) {
    if(!text || text.trim() === "") return showToast("âš ï¸ TYPE SOMETHING FIRST!", "#ff0055");
    const id = Date.now() + Math.floor(Math.random() * 100000);
    const item = { id: id, type: 'text', data: text, fav: false, date: new Date().toLocaleDateString() };
    myGallery.unshift(item);
    localStorage.setItem('arcadeGallery', JSON.stringify(myGallery));
    refreshGalleryIfOpen();
    showToast("ğŸ’¾ TEXT SAVED", "#00ff00");
}

function refreshGalleryIfOpen() {
    if(document.getElementById('gallery-wrapper') && document.getElementById('gallery-wrapper').style.display === 'flex') {
        renderGallery();
    }
}

// 4. UI Logic
function toggleGalleryUI() {
    let el = document.getElementById('gallery-wrapper');
    if(!el) { createGalleryUI(); el = document.getElementById('gallery-wrapper'); }
    
    if(el.style.display === 'flex') {
        el.style.display = 'none';
        document.body.style.overflow = 'auto'; 
    } else {
        el.style.display = 'flex';
        document.body.style.overflow = 'hidden'; 
        renderGallery();
    }
    if(typeof playClick === 'function') playClick();
}

function createGalleryUI() {
    if(document.getElementById('gallery-wrapper')) return;
    
    const div = document.createElement('div');
    div.id = 'gallery-wrapper';
    div.style.cssText = "display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(10, 10, 16, 0.95); backdrop-filter:blur(15px); -webkit-backdrop-filter:blur(15px); z-index:9999; flex-direction:column; padding:20px; box-sizing:border-box; overflow-y:auto; transition: opacity 0.3s ease;";
    
    div.innerHTML = `
        <div style="display:flex; justify-content:center; align-items:center; margin-bottom:25px; position:sticky; top:0; z-index:10;">
            <div style="background:rgba(0,0,0,0.6); padding:10px 20px; border-radius:30px; border:1px solid #333; backdrop-filter:blur(5px); display:flex; align-items:center; gap:15px; box-shadow:0 10px 30px rgba(0,0,0,0.5);">
                <h2 style="color:#fff; font-family:'Courier New', monospace; font-weight:800; margin:0; letter-spacing:1px; font-size: 18px;">MY STUDIO</h2>
                <button onclick="toggleGalleryUI()" style="background:none; border:1px solid #ff0055; color:#ff0055; font-weight:bold; padding:5px 12px; border-radius:15px; font-size:12px; cursor:pointer; transition:0.2s;">CLOSE</button>
            </div>
        </div>
        <div id="gallery-grid" style="display:grid; grid-template-columns:repeat(2, 1fr); gap:15px; padding-bottom:80px; max-width:600px; margin:0 auto; width:100%;"></div>
        <div id="empty-msg" style="color:#666; text-align:center; margin-top:100px; display:none; font-family:monospace; letter-spacing:1px;">
            <div style="font-size:40px; margin-bottom:10px; opacity:0.5;">ğŸ’¾</div>
            NO SAVED ITEMS YET
        </div>
    `;
    document.body.appendChild(div);
}

function toggleFav(index) {
    if (myGallery[index]) {
        myGallery[index].fav = !myGallery[index].fav;
        if (myGallery[index].fav) {
            const item = myGallery.splice(index, 1)[0];
            myGallery.unshift(item);
        }
        localStorage.setItem('arcadeGallery', JSON.stringify(myGallery));
        renderGallery();
        if (typeof playClick === 'function') playClick();
    }
}

function renderGallery() {
    const grid = document.getElementById('gallery-grid');
    const empty = document.getElementById('empty-msg');
    grid.innerHTML = ''; 
    if(myGallery.length === 0) { empty.style.display = 'block'; return; }
    empty.style.display = 'none';

    myGallery.forEach((item, index) => {
        const card = document.createElement('div');
        card.style.cssText = "position:relative; border-radius:16px; overflow:hidden; background:linear-gradient(145deg, #1a1a1a, #0d0d0d); display:flex; flex-direction:column; box-shadow: 0 4px 15px rgba(0,0,0,0.6); border:1px solid #333; transition: transform 0.2s;";
        if(item.type === 'text') {
            const textBox = document.createElement('div');
            textBox.style.cssText = "padding:20px; color:#00ffcc; font-family:'Courier New', monospace; font-size:14px; line-height:1.4; word-break:break-word; background:rgba(0,0,0,0.3); flex-grow:1; min-height:120px; white-space: pre-wrap; display:flex; align-items:center; justify-content:center; text-align:center;";
            textBox.innerText = item.data;
            card.appendChild(textBox);
            card.style.border = "1px solid #00ffcc44";
        } else {
            const img = document.createElement('img');
            img.src = item.data || item.img; 
            img.style.cssText = "width:100%; height:auto; display:block; aspect-ratio:1/1; object-fit:cover;";
            card.appendChild(img);
        }
        const bar = document.createElement('div');
        bar.style.cssText = "width:100%; background:#000; display:flex; justify-content:space-between; align-items:center; padding:10px 15px; box-sizing:border-box; border-top:1px solid #222;";
        const leftGrp = document.createElement('div');
        leftGrp.style.display = 'flex'; leftGrp.style.alignItems = 'center'; leftGrp.style.gap = '20px'; 
        const favBtn = document.createElement('span');
        favBtn.innerHTML = item.fav ? "â˜…" : "â˜†"; 
        favBtn.style.cssText = item.fav ? "color:#ffff00; font-size:22px; cursor:pointer; text-shadow:0 0 8px #ffff00;" : "color:#555; font-size:22px; cursor:pointer;";
        favBtn.onclick = (e) => { e.stopPropagation(); toggleFav(index); };
        leftGrp.appendChild(favBtn);
        if(item.type !== 'text') {
            const dlBtn = document.createElement('span');
            dlBtn.innerHTML = "â¬‡ï¸";
            dlBtn.style.cssText = "font-size:18px; cursor:pointer; opacity:0.8; color:#00ffff; margin-top:2px;"; 
            dlBtn.onclick = (e) => { e.stopPropagation(); downloadFromGallery(item.data); };
            leftGrp.appendChild(dlBtn);
        }
        if(item.type === 'text') {
            const copyBtn = document.createElement('span');
            copyBtn.innerHTML = "ğŸ“‹";
            copyBtn.style.cssText = "font-size:18px; cursor:pointer; opacity:0.7; margin-top:2px;";
            copyBtn.onclick = (e) => { e.stopPropagation(); navigator.clipboard.writeText(item.data); showToast("COPIED!", "#fff"); };
            leftGrp.appendChild(copyBtn);
        }
        const delBtn = document.createElement('span');
        delBtn.innerHTML = "ğŸ—‘ï¸";
        delBtn.style.cssText = "font-size:18px; cursor:pointer; opacity:0.6; color:#ff4444;";
        delBtn.onclick = function(e) { e.stopPropagation(); deleteItem(item.id); };
        bar.appendChild(leftGrp); bar.appendChild(delBtn); card.appendChild(bar);
        if(item.type === 'text') card.style.gridColumn = "span 2";
        grid.appendChild(card);
    });
}

function showToast(text, color) {
    const existingToast = document.getElementById('my-toast');
    if(existingToast) existingToast.remove();
    const t = document.createElement('div');
    t.id = 'my-toast'; t.innerHTML = text;
    t.style.cssText = `position:fixed; bottom:30px; left:50%; transform:translateX(-50%) translateY(20px); background:rgba(0,0,0,0.9); border:1px solid ${color}; color:${color}; padding:12px 24px; border-radius:50px; font-family:sans-serif; font-weight:bold; font-size:14px; z-index:10001; opacity:0; transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275); box-shadow: 0 5px 20px rgba(0,0,0,0.5); display:flex; align-items:center; gap:8px; white-space:nowrap;`;
    document.body.appendChild(t);
    requestAnimationFrame(() => { t.style.opacity = "1"; t.style.transform = "translateX(-50%) translateY(0)"; });
    setTimeout(() => { t.style.opacity = "0"; t.style.transform = "translateX(-50%) translateY(20px)"; setTimeout(() => t.remove(), 300); }, 2000);
}
    
function downloadFromGallery(base64Data) {
    fetch(base64Data).then(res => res.blob()).then(blob => {
        const uniqueName = `Arcade_Backup_${Date.now()}_${Math.floor(Math.random() * 9999)}.png`;
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url; a.download = uniqueName;
        document.body.appendChild(a); a.click();
        setTimeout(() => { document.body.removeChild(a); window.URL.revokeObjectURL(url); }, 100);
    });
    if(typeof playClick === 'function') playClick();
}

let deleteTargetId = null;
function deleteItem(id) { deleteTargetId = id; createDeleteModal(); toggleDeleteModal(true); }
function toggleDeleteModal(show) {
    const m = document.getElementById('del-modal');
    if(m) m.style.display = show ? 'flex' : 'none';
    if(show && typeof playClick === 'function') playClick();
}
function executeDelete() {
    if(deleteTargetId !== null) {
        myGallery = myGallery.filter(x => x.id != deleteTargetId);
        localStorage.setItem('arcadeGallery', JSON.stringify(myGallery));
        renderGallery(); showToast("ITEM DELETED", "#ff4444");
        toggleDeleteModal(false);
        if(typeof playShutter === 'function') playShutter();
    }
}
function createDeleteModal() {
    if(document.getElementById('del-modal')) return;
    const d = document.createElement('div');
    d.id = 'del-modal';
    d.style.cssText = "display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.9); z-index:100000; justify-content:center; align-items:center; backdrop-filter:blur(8px); -webkit-backdrop-filter:blur(8px);";
    d.innerHTML = `
        <div style="background:#0a0a0c; border:2px solid #ff0000; padding:25px; border-radius:20px; width:280px; text-align:center; box-shadow:0 0 40px rgba(255,0,0,0.4); animation: popIn 0.2s cubic-bezier(0.175, 0.885, 0.32, 1.275);">
            <div style="font-size:50px; margin-bottom:15px; text-shadow:0 0 20px rgba(255,0,0,0.5);">ğŸ—‘ï¸</div>
            <h3 style="color:#fff; font-family:'Courier New', monospace; margin:0 0 10px 0; text-transform:uppercase; font-weight:900; letter-spacing:1px; font-size:20px;">DELETE ITEM?</h3>
            <p style="color:#888; font-size:12px; margin-bottom:25px; font-weight:bold; font-family:sans-serif;">THIS ACTION CANNOT BE UNDONE.</p>
            <div style="display:flex; gap:10px; justify-content:center;">
                <button onclick="toggleDeleteModal(false)" style="background:#222; color:#aaa; border:1px solid #444; padding:12px 20px; border-radius:8px; font-weight:bold; cursor:pointer; flex:1; font-size:12px;">CANCEL</button>
                <button onclick="executeDelete()" style="background:#ff0000; color:#fff; border:none; padding:12px 20px; border-radius:8px; font-weight:bold; cursor:pointer; box-shadow:0 0 15px #ff0000; flex:1; font-size:12px;">DELETE</button>
            </div>
        </div>
        <style>@keyframes popIn { from { transform: scale(0.8); opacity: 0; } to { transform: scale(1); opacity: 1; } }</style>
    `;
    document.body.appendChild(d);
}

setInterval(() => {
    const symBox = document.getElementById('sym-box');
    if(symBox && !document.getElementById('save-sym-btn')) {
        const btn = document.createElement('button');
        btn.id = 'save-sym-btn'; btn.innerHTML = "ğŸ’¾ SAVE TO STUDIO";
        btn.style.cssText = "width:100%; background:linear-gradient(90deg, #111, #222); color:#00ffcc; border:1px solid #00ffcc; padding:12px; margin-top:8px; margin-bottom:20px; font-weight:bold; border-radius:8px; cursor:pointer; letter-spacing:1px; transition:0.2s;";
        btn.onclick = () => saveTextToGallery(symBox.value);
        symBox.parentNode.insertBefore(btn, symBox.nextSibling);
    }
    const fontInput = document.getElementById('font-input'); 
    if(fontInput && !document.getElementById('save-font-btn')) {
        const btn = document.createElement('button');
        btn.id = 'save-font-btn'; btn.innerHTML = "ğŸ’¾ SAVE TO STUDIO";
        btn.style.cssText = "width:100%; background:linear-gradient(90deg, #111, #222); color:#00ffcc; border:1px solid #00ffcc; padding:12px; margin-top:8px; margin-bottom:20px; font-weight:bold; border-radius:8px; cursor:pointer; letter-spacing:1px; transition:0.2s;";
        btn.onclick = () => saveTextToGallery(fontInput.value);
        fontInput.parentNode.insertBefore(btn, fontInput.nextSibling);
    }
    const menu = document.querySelector('.ui');
    if (menu && !document.getElementById('open-gal-btn')) {
        const btn = document.createElement('button');
        btn.id = 'open-gal-btn'; btn.innerHTML = "ğŸ“‚ MY STUDIO";
        btn.style.cssText = "width:100%; background:linear-gradient(180deg, #1a1a1a, #000); color:#fff; border:1px solid #333; margin-bottom:10px; padding:14px; font-weight:bold; border-radius:10px; cursor:pointer; box-shadow:0 4px 10px rgba(0,0,0,0.5); letter-spacing:1px; font-family:sans-serif;";
        btn.onclick = toggleGalleryUI;
        menu.insertBefore(btn, menu.firstChild);
    }
}, 1000);
</script>
</body>
</html>
